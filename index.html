<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Segwik Mobile – vCard → Download Journey Onboarding</title>
<style>
  :root{
    --bg:#f6f8fb; --ink:#243048; --muted:#667085; --line:#e6ebf2;
    --accent:#0F2D56; --blue:#2563eb; --blue-700:#1d4ed8; --blue-50:#eef2ff;
    --card:#fff; --radius:16px; --shadow:0 14px 38px rgba(0,0,0,.08);
    --phone-w:430px; --phone-h:800px; --footer-h:48px; --status-h:46px;
    --nav-safe: 140px; --green:#22c55e;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;display:grid;place-items:center;background:var(--bg);color:var(--ink);font-family:Segoe UI,system-ui,-apple-system,sans-serif}
  svg{stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
  .phone{width:var(--phone-w);height:var(--phone-h);background:#fff;border-radius:36px;border:8px solid #111;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,.12),0 8px 16px rgba(0,0,0,.08);position:relative}
  .notch{position:absolute;top:8px;left:50%;transform:translateX(-50%);width:180px;height:30px;background:#111;border-radius:20px 20px 28px 28px;z-index:10}
  .status{height:var(--status-h);display:flex;align-items:center;justify-content:center;border-bottom:1px solid var(--line);font-weight:800;color:var(--accent)}
  .screen{flex:1;position:relative;background:var(--bg);height:calc(100% - var(--status-h) - var(--footer-h));overflow:hidden}
  .tray{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;padding:8px;border-top:1px solid var(--line);background:#fff}
  .ibtn{padding:8px;border:1px solid var(--line);border-radius:12px;background:#f8fafc;display:grid;place-items:center}
  .btn{appearance:none;border:1px solid var(--line);background:#fff;color:var(--accent);padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
  .btn.blue{background:var(--blue);border-color:var(--blue);color:#fff}
  .btn.blue:hover{background:var(--blue-700);border-color:var(--blue-700)}
  .btn.ghost{background:#f8fafc}
  .btn.small{padding:8px 10px;border-radius:10px;font-size:12px}
  .btn.full{width:100%}
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 12px;font-weight:700;cursor:pointer}
  .chip.active{background:#eff6ff;border-color:#c7d2fe}

  .carousel{height:100%;display:flex;transition:transform .32s cubic-bezier(.22,.61,.36,1);will-change:transform}
  .slide{min-width:100%;height:100%;padding:14px;display:flex;flex-direction:column}
  .head{padding:6px 2px 8px}
  .h1{font-weight:900;color:var(--accent);font-size:18px}
  .p{font-size:13px;color:var(--muted);line-height:1.5}
  .scroll{flex:1;min-height:0;overflow:auto;display:flex;flex-direction:column;gap:12px;padding-bottom:var(--nav-safe)}
  .card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:14px}
  .label{font-size:12px;color:var(--muted);font-weight:800;margin-bottom:6px}
  input[type="text"],input[type="email"],input[type="url"],textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#f8fafc;font:inherit}
  textarea{min-height:110px;resize:vertical}
  .split{display:grid;grid-template-columns:1fr 1fr;gap:10px}

  .nav{position:absolute;left:0;right:0;bottom:var(--footer-h);display:flex;justify-content:space-between;gap:8px;padding:0 14px;z-index:5}
  .pager{position:absolute;left:0;right:0;bottom:calc(var(--footer-h) + 42px);display:flex;justify-content:center;gap:6px;pointer-events:auto;z-index:5}
  .dot{width:8px;height:8px;border-radius:50%;background:#c9d2e4;opacity:.9;cursor:pointer}
  .dot.active{background:var(--accent)}

  /* vCard tiles in the inline/peek previews */
  .vcard{border:1px solid #e6ebf2;border-radius:18px;overflow:hidden}
  .v-banner{position:relative;height:180px;background:#dbe6ff url('https://images.unsplash.com/photo-1551817958-d33c6c9f24a1?q=80&w=1200&auto=format&fit=crop') center/cover}
  .v-banner::after{content:"";position:absolute;inset:0;background:linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,0) 50%)}
  .v-save{position:absolute;right:14px;bottom:-22px}
  .v-head{display:flex;gap:12px;align-items:flex-end;padding:28px 14px 12px}
  .v-photo{width:84px;height:84px;border-radius:50%;border:3px solid #fff;background:#e5edf8;background-size:cover;background-position:center;box-shadow:0 4px 12px rgba(0,0,0,.12)}
  .v-name{font-weight:900;font-size:20px;margin:6px 0 2px}
  .v-company{font-weight:700;color:#0b1220}
  .v-headline{color:#6a768f;margin-top:6px}
  .v-list{padding:8px 14px 16px;display:grid;gap:12px}
  .v-row{display:flex;gap:10px;align-items:flex-start}
  .vcard .v-row .ico{width:22px;height:22px;border-radius:50%;display:grid;place-items:center;background:#000;color:#fff;flex:0 0 22px}
  .vcard .v-row .ico svg,.vcard .v-row .ico svg *{stroke:#fff !important;fill:none !important;width:14px;height:14px;display:block}

  /* Phone-styled email preview */
  .phone-modal{ position:absolute; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:3200; }
  .phone-modal.show{ display:flex; }
  .phone-frame{ width:360px; max-width:92vw; background:#fff; border:1px solid #e5e7eb; border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.18); overflow:hidden; }
  .phone-titlebar{ display:flex; gap:6px; align-items:center; padding:10px; background:#f9fafb; border-bottom:1px solid #eef1f6; }
  .dot-r{width:10px;height:10px;border-radius:50%;background:#ef4444}
  .dot-o{width:10px;height:10px;border-radius:50%;background:#f59e0b}
  .dot-g{width:10px;height:10px;border-radius:50%;background:#22c55e}
  .email-preview{ max-height:60vh; overflow:auto; }
  .mail-frame{border:0;border-radius:0;background:#fff}
  .mail-topbar{display:flex;justify-content:flex-start;align-items:center;padding:10px 12px;border-bottom:1px solid #eef1f6}
  .mail-topbar .subject{font-weight:800}
  .mail-body{padding:14px;line-height:1.55}
  .mail-body p{margin:0 0 10px 0}
  .cta{display:inline-flex;align-items:center;gap:8px;padding:10px 14px;border-radius:12px;border:1px solid #cfe1ff;background:#eef4ff;font-weight:800;color:#0F2D56;text-decoration:none}
  .cta.blue{background:var(--blue);border-color:var(--blue);color:#fff}
  .sig{display:flex; gap:12px; align-items:flex-start; margin-top:14px; border-top:1px solid #eef1f6; padding-top:12px;}
  .sig img{width:48px;height:48px;border-radius:50%;object-fit:cover;border:2px solid #fff;box-shadow:0 2px 6px rgba(0,0,0,.06)}
  .sig .meta{font-size:13px;color:#334155}
  .sig .meta .name{font-weight:800;color:#111827}
  .sig .socials{display:flex;gap:8px;margin-top:6px}

  /* Upgrade modal */
  .modal-wrap{ position:absolute; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:3000; }
  .modal-wrap.show{ display:flex; }
  .modal{ background:#fff; border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow); width:92%; max-width:380px; padding:16px; }
  .modal h3{ margin:0 0 8px 0; font-size:16px; color:var(--accent); }
  .modal p{ margin:0 0 12px 0; color:var(--muted); }
  .modal .row{ display:flex; gap:8px; justify-content:flex-end; }

  .setup-image{ display:block; width:auto; height:360px; margin:0 auto 16px; border-radius:8px; object-fit:contain; }

  .uploader{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
  .drop{ border:2px dashed #bfd3ff; background:#f5f8ff; color:#0F2D56; padding:14px; border-radius:14px; cursor:pointer; display:flex; gap:12px; align-items:center; transition:.18s ease; position:relative; min-height:74px; }
  .drop:hover{ background:#eef4ff; border-color:#9ab8ff; }
  .drop:active{ background:#e5eeff; }
  .drop .ico{ width:40px; height:40px; border-radius:10px; background:#fff; display:grid; place-items:center; border:1px solid #e6ebf2; }
  .drop .txt{ font-size:12px; line-height:1.35; }
  .drop .txt b{ display:block; font-size:13px; }
  .drop input[type="file"]{ position:absolute; inset:0; opacity:0; cursor:pointer; }
  .thumb{ position:absolute; right:10px; top:10px; width:48px; height:48px; border-radius:12px; border:1px solid #e6ebf2; background:#fff center/cover no-repeat; box-shadow:0 2px 6px rgba(0,0,0,.06); }

  .social-row{display:grid; grid-template-columns:160px 1fr 36px; gap:8px; align-items:center}
  .social-row select, .social-row input{padding:10px 12px; border:1px solid var(--line); background:#f8fafc; border-radius:10px; font:inherit}
  .social-row .remove{appearance:none; border:1px solid var(--line); background:#fff; border-radius:10px; width:36px; height:36px; display:grid; place-items:center; cursor:pointer}
  .social-add{margin-top:10px}
  .peek-trigger{display:inline-flex; align-self:flex-end}

  /* AI loader */
  .ai-overlay{position:absolute; inset:0; background:rgba(255,255,255,.8); display:none; align-items:center; justify-content:center; z-index:2500; font-weight:800; color:#0F2D56;}
  .ai-overlay.show{display:flex;}

  /* Toggle */
  .switch{position:relative;width:56px;height:30px;background:#e5e7eb;border-radius:999px;cursor:pointer;transition:.18s ease;border:1px solid #d1d5db}
  .switch.on{background:var(--green);border-color:var(--green)}
  .knob{position:absolute;top:3px;left:3px;width:24px;height:24px;background:#fff;border-radius:50%;box-shadow:0 1px 3px rgba(0,0,0,.2);transition:.18s ease}
  .switch.on .knob{left:29px}

  /* ==== Peek sheet ==== */
  .peeksheet-wrap{ position:absolute; inset:0; background:rgba(15,45,86,.28); display:none; align-items:flex-end; z-index:2000; }
  .peeksheet-wrap.show{ display:flex; }
  .peeksheet{
    width:100%; height:calc(100% - 6px); max-height:100%;
    background:#fff; border-top:1px solid var(--line);
    border-radius:24px 24px 0 0; box-shadow:var(--shadow);
    padding:0; display:flex; flex-direction:column;
    transform:translateY(100%); animation:peekSlideUp .25s ease forwards;
  }
  @keyframes peekSlideUp{ to{ transform:translateY(0) } }
  .peeksheet-top{
    display:flex; align-items:center; justify-content:space-between; gap:8px;
    padding:14px 16px; border-bottom:1px solid var(--line); background:#fff;
    position:sticky; top:0; z-index:1;
  }
  .peeksheet-title{ font-weight:900; color:var(--accent); }
  .peeksheet-close{
    appearance:none; border:0; background:#f8fafc; border:1px solid var(--line);
    border-radius:10px; padding:6px 10px; cursor:pointer; font-size:18px; line-height:1;
  }
  .peeksheet-body{ flex:1; overflow:auto; -webkit-overflow-scrolling:touch; padding:14px 16px 22px; }

  /* Demo vCard inside the sheet (exact look) */
  .vcard-demo{ width:100%; border:1px solid #e6ebf2; border-radius:18px; overflow:hidden; background:#fff; box-shadow:var(--shadow); }
  .v-demo-banner{ height:180px; background:#eef2f7; background-size:cover; background-position:center; }
  .v-demo-headrow{ display:flex; align-items:flex-end; gap:12px; padding:18px 14px 8px; }
  .v-demo-photo{
    width:84px; height:84px; border-radius:50%; border:3px solid #fff;
    background:#e9edf3; display:grid; place-items:center; color:#9aa4b2;
    box-shadow:0 4px 12px rgba(0,0,0,.08);
    background-size:cover; background-position:center;
  }
  .v-demo-photo svg{ width:30px; height:30px; }
  .v-demo-save{
    margin-left:auto; margin-bottom:6px; appearance:none; border:0;
    background:#2563eb; color:#fff; padding:10px 14px; border-radius:14px; font-weight:800;
  }
  .v-demo-id{ line-height:1.45; padding:0 14px 10px; }
  .v-demo-name{ font-weight:900; font-size:20px; color:#0b1220; }
  .v-demo-company{ color:#263043; font-weight:700; }
  .v-demo-title{ color:#111827; font-weight:800; }
  .v-demo-headline{ color:#6b7280; }

  .v-demo-list{ padding:10px 14px 18px; display:grid; gap:14px; }
  .v-demo-row{ display:flex; gap:10px; align-items:center; color:#1f2937; }
  .icon-pill{ width:28px; height:28px; border-radius:50%; background:#000; display:grid; place-items:center; }
  .icon-pill svg{ width:14px; height:14px; stroke:#fff; fill:none; stroke-width:2; }

  .peek-trigger{ display:inline-flex; align-self:flex-end; }
</style>
</head>
<body>
  <div class="phone">
    <div class="notch"></div>
    <div class="status"></div>

    <div class="screen">
      <div id="carousel" class="carousel">

        <!-- Step 0: Welcome -->
        <section class="slide">
          <div class="head">
            <div class="h1">Let’s build your account profile.</div>
            <div class="p">This profile helps personalize your Segwik experience and keeps your information consistent across your journeys and automations</div>
          </div>

          <div class="scroll">
            <div class="card">
              <img src="https://d34hmiuaex7c0.cloudfront.net/2952/uploads/cmaspages/gallery/galleryitem_1760702903557.png" alt="vCard setup preview" class="setup-image"/>
              <div class="p" style="margin-bottom:12px">
                Please snap a pic of your business card, front and back.

              </div>
              <div class="row">
                <button id="skip" class="btn">Skip</button>
                <button id="startCard" class="btn blue" style="margin-left:auto">Save & Continue</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Step 1: vCard — Profile -->
        <section class="slide">
          <div class="head">
            <div class="h1">Confirm Profile Details</div>
            <div class="p">This will be part of your digital business card, helping you look great and show up professionally when you meet new people.</div>
          </div>
          <div class="scroll">
            <div class="card">
              <div class="split">
                <div>
                  <div class="label">First Name</div>
                  <input id="firstName" type="text" placeholder="Pete">
                </div>
                <div>
                  <div class="label">Last Name</div>
                  <input id="lastName" type="text" placeholder="Romano">
                </div>
              </div>
              <div class="split" style="margin-top:10px">
                <div>
                  <div class="label">Title / Role</div>
                  <input id="title" type="text" placeholder="Founder">
                </div>
                <div>
                  <div class="label">Company Name</div>
                  <input id="company" type="text" placeholder="Segwik">
                </div>
              </div>
              <div style="margin-top:10px">
                <div class="label">Headline</div>
                <input id="headline" type="text" placeholder="Freeing Businesses of Mundane and Repetitive Tasks">
              </div>
            </div>

            <div class="card">
              <div class="label">Upload Images</div>
              <div class="uploader">
                <label class="drop" id="photoDrop">
                  <span class="ico"><svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></span>
                  <span class="txt"><b>Upload Headshot</b>PNG or JPG, square works best</span>
                  <input id="photo" type="file" accept="image/*">
                  <span class="thumb" id="photoThumb" aria-hidden="true" style="display:none"></span>
                </label>
                <label class="drop" id="bannerDrop">
                  <span class="ico"><svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></span>
                  <span class="txt"><b>Upload Background</b>Wide cover image looks great</span>
                  <input id="banner" type="file" accept="image/*">
                  <span class="thumb" id="bannerThumb" aria-hidden="true" style="display:none"></span>
                </label>
              </div>
            </div>

            <!-- Bottom of step: peek trigger -->
            <button class="btn peek-trigger" data-peek>👁 Where will this appear?</button>
          </div>
        </section>

        <!-- Step 2: vCard — Contact & Social -->
        <section class="slide">
          <div class="head">
            <div class="h1">Confirm Contact & Social Details</div>
            <div class="p">This will also appear in your digital business card — a simple way to make sure you always show up polished and professional.</div>
          </div>
          <div class="scroll">

            <div class="card">
              <div class="label">Phones</div>
              <div class="split">
                <div><input id="phoneBiz" type="text" placeholder="Business (555) 123-4567"></div>
                <div><input id="phonePersonal" type="text" placeholder="Personal (555) 987-6543"></div>
              </div>
              <div class="label" style="margin-top:10px">Emails</div>
              <div class="split">
                <div><input id="emailBiz" type="email" placeholder="business@company.com"></div>
                <div><input id="emailPersonal" type="email" placeholder="personal@email.com"></div>
              </div>
              <div style="margin-top:10px">
                <div class="label">Website</div>
                <input id="website" type="url" placeholder="https://www.segwik.com">
              </div>
            </div>

            <div class="card">
              <div class="label">Social Links</div>
              <div id="socialList"></div>
              <button id="addSocial" class="btn social-add">+ Add social link</button>
              <div class="p" style="margin-top:6px">Choose one or more platforms, then paste the URL.</div>
            </div>

            <!-- Bottom of step: peek trigger -->
            <button class="btn peek-trigger" data-peek>👁 Where will this appear?</button>
          </div>
        </section>

        <!-- Step 3: vCard — Live Preview (inline matches peek sheet) -->
        <section class="slide">
          <div class="head">
            <div class="h1">Preview Your Digital Card</div>
            <div class="p">This is what people will see when you share your link or QR code.</div>
          </div>
          <div class="scroll">
            <!-- Inline vCard preview (same structure as the 👁 peek sheet) -->
            <div class="card">
              <div class="vcard-demo" id="vcardInline">
                <!-- Filled by JS to mirror the peek sheet -->
              </div>
            </div>

            <div class="card">
              <div id="cardStatus" class="p"></div>
              <div class="row" style="margin-top:8px">
                <button id="btnPreviewCard" class="btn">Open vCard Link</button>
                <button id="btnFillInfo" class="btn blue" style="margin-left:auto">Fill In Information</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Step 4: Journey — Choose actions -->
        <section class="slide">
          <div class="head">
            <div class="h1">Phase 2: After you meet a prospect, what should happen?</div>
            <div class="p">Select all actions you want Segwik to automate.</div>
          </div>
          <div class="scroll">
            <div class="card">
              <div class="chips" id="actionChips"></div>
              <div class="right" style="margin-top:12px">
                <button id="toEmailCfg" class="btn blue">Continue</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Step 5: Email — Single CTA -->
        <section class="slide">
          <div class="head">
            <div class="h1">When someone receives your email, what should they do?</div>
            <div class="p">Choose <strong>one</strong> action for your autoresponder.</div>
          </div>
          <div class="scroll">
            <div class="card" id="ctaBuilder"></div>
            <div class="card">
              <div class="right">
                <button id="toPersonality" class="btn blue">Continue</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Step 6: Brand Personality -->
        <section class="slide">
          <div class="head">
            <div class="h1">How do you see yourself in the market?</div>
            <div class="p">Select all that describe your brand personality. Your AI-written autoresponder will match this tone.</div>
          </div>
          <div class="scroll">
            <div class="card" id="personaPicker"></div>
            <div class="right" style="margin-top:12px">
              <button id="toContent" class="btn blue">Continue</button>
            </div>
          </div>
        </section>

        <!-- Step 7: Content + AI generate -->
        <section class="slide">
          <div class="head">
            <div class="h1">Tell us about your business</div>
            <div class="p">You can write your own or let AI draft and then edit.</div>
          </div>
          <div class="scroll" style="position:relative">
            <div class="ai-overlay" id="aiOverlay">Generating your copy…</div>

            <div class="card">
              <div class="row" style="display:flex;gap:8px;flex-wrap:wrap">
                <button id="genAI" class="btn">Generate with AI</button>
                <button id="regenAI" class="btn ghost">Regenerate</button>
              </div>
            </div>

            <div class="card">
              <div class="label">Company Overview</div>
              <textarea id="coOverview" placeholder="Describe what your company does…"></textarea>
            </div>
            <div class="card">
              <div class="label">Mission Statement</div>
              <textarea id="coMission" placeholder="State your mission…"></textarea>
            </div>
            <div class="card">
              <div class="label">Organization Values</div>
              <textarea id="coValues" placeholder="List a few core values…"></textarea>
            </div>
            <div class="card">
              <div class="label">Differentiating Propositions</div>
              <textarea id="coDiff" placeholder="What makes you different…"></textarea>
            </div>

            <button id="peekEmail1" class="btn">👁 Where will this appear?</button>

            <div class="right">
              <button id="toLogo" class="btn blue">Continue</button>
            </div>
          </div>
        </section>

        <!-- Step 8: Subject + Logo upload -->
        <section class="slide">
          <div class="head">
            <div class="h1">Subject & Logo</div>
            <div class="p">We’ll include your logo at the top of the autoresponder.</div>
          </div>
          <div class="scroll">
            <div class="card">
              <div class="label">Subject Line</div>
              <input id="subjectLine" type="text" value="It’s great to be connected!">
            </div>

            <div class="card">
              <div class="uploader" style="grid-template-columns:1fr">
                <label class="drop" id="logoDrop">
                  <span class="ico"><svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></span>
                  <span class="txt"><b>Upload Logo</b>PNG with transparent background works best</span>
                  <input id="logo" type="file" accept="image/*">
                  <span class="thumb" id="logoThumb" aria-hidden="true" style="display:none"></span>
                </label>
              </div>
            </div>

            <button id="peekEmail2" class="btn">👁 Where will this appear?</button>

            <div class="right">
              <button id="finish" class="btn blue">Continue</button>
            </div>
          </div>
        </section>

        <!-- Step 9: Summary with toggle -->
        <section class="slide">
          <div class="head">
            <div class="h1">Your vCard Download Journey is ready</div>
            <div class="p">Share your card link or QR, and we’ll handle the follow-up.</div>
          </div>
          <div class="scroll">
            <div class="card">
              <ul style="margin:0;padding-left:18px;line-height:1.8">
                <li><span id="sumCard" class="ok">Digital card complete</span></li>
                <li><span class="ok">Instant autoresponder configured</span></li>
                <li><span id="sumCtas" class="ok">CTA added</span></li>
              </ul>
              <div class="row" style="margin-top:12px;align-items:center;gap:12px">
                <div style="font-weight:800">Activate Journey</div>
                <div id="toggle" class="switch" role="switch" aria-checked="false"><span class="knob"></span></div>
              </div>
            </div>
          </div>
        </section>
      </div>

      <!-- Back/Next + pager -->
      <div class="nav">
        <button id="backBtn" class="btn small ghost">Back</button>
        <button id="nextBtn" class="btn small">Next</button>
      </div>
      <div id="pager" class="pager"></div>

      <!-- Upgrade modal -->
      <div id="upgradeModal" class="modal-wrap" role="dialog" aria-modal="true" aria-labelledby="upgTitle">
        <div class="modal">
          <h3 id="upgTitle">Unlock more automations</h3>
          <p>Upgrade to <strong>Segwik Grow</strong> to enable additional CTAs and more automations.</p>
          <div class="row">
            <button class="btn ghost" id="upgClose">Not now</button>
            <button class="btn blue" id="upgGo">See plans</button>
          </div>
        </div>
      </div>

      <!-- vCard peek sheet (steps 1–2) -->
      <div id="peekProfileSheet" class="peeksheet-wrap" aria-hidden="true" onclick="if(event.target.id==='peekProfileSheet'){togglePeek(false)}">
        <div class="peeksheet" role="dialog" aria-modal="true" aria-label="vCard field preview" onclick="event.stopPropagation()">
          <div class="peeksheet-top">
            <div class="peeksheet-title">Where this info appears on your vCard</div>
            <button id="peekProfileClose" class="peeksheet-close" aria-label="Close">×</button>
          </div>
          <div class="peeksheet-body">
            <div class="vcard-demo">
              <div class="v-demo-banner" id="peekDemoBanner"></div>
              <div class="v-demo-headrow">
                <div class="v-demo-photo" id="peekDemoPhoto">
                  <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>
                </div>
                <button class="v-demo-save">Save Contact</button>
              </div>
              <div class="v-demo-id">
                <div class="v-demo-name" id="peekName">Your Name</div>
                <div class="v-demo-company" id="peekCompany">Your Company</div>
                <div class="v-demo-title" id="peekTitle">Your Title</div>
                <div class="v-demo-headline" id="peekHeadline">Your Headline</div>
              </div>
              <div class="v-demo-list" id="peekList"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Phone-styled email preview -->
      <div id="phonePreview" class="phone-modal" aria-hidden="true" onclick="if(event.target.id==='phonePreview'){togglePhone(false)}">
        <div class="phone-frame" onclick="event.stopPropagation()">
          <div class="phone-titlebar">
            <div class="dot-r"></div><div class="dot-o"></div><div class="dot-g"></div>
            <div id="phoneTitle" style="margin-left:8px;font-weight:800;color:#0F2D56">It’s great to be connected!</div>
            <button id="phoneClose" class="btn small ghost" style="margin-left:auto">Close</button>
          </div>
          <div class="email-preview">
            <div class="mail-frame" id="mailPreview"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Bottom icon tray -->
    <div class="tray" id="footer-tray">
      <div class="ibtn" data-icon="home"></div>
      <div class="ibtn" data-icon="card"></div>
      <div class="ibtn" data-icon="flow"></div>
      <div class="ibtn" data-icon="mail"></div>
      <div class="ibtn" data-icon="user"></div>
    </div>
  </div>

<script>
/* ========= Carousel / Pager ========= */
const carousel = document.getElementById('carousel');
const slides = Array.from(carousel.children);
let idx = 0;
function goTo(i){
  idx = Math.max(0, Math.min(slides.length-1, i));
  carousel.style.transform = `translateX(-${idx*100}%)`;
  renderDots(); updateNav();
  if(idx===2){ renderStatus(); renderInlineVcardFromInputs(); } // Step 3
}
function renderDots(){
  const pager = document.getElementById('pager');
  if(!pager) return;
  pager.innerHTML='';
  slides.forEach((_,i)=>{
    const d=document.createElement('div');
    d.className='dot'+(i===idx?' active':'');
    d.onclick=()=>goTo(i);
    pager.appendChild(d);
  });
}
function updateNav(){
  const back = document.getElementById('backBtn');
  const next = document.getElementById('nextBtn');
  if(!back || !next) return;
  back.classList.toggle('ghost', idx===0);
  next.textContent = idx===slides.length-1 ? 'Done' : 'Next';
}
document.getElementById('backBtn')?.addEventListener('click', ()=>goTo(idx-1));
document.getElementById('nextBtn')?.addEventListener('click', ()=>goTo(idx+1));
renderDots(); updateNav();

/* quick nav */
document.getElementById('startCard')?.addEventListener('click', ()=>goTo(1));
document.getElementById('skip')?.addEventListener('click', ()=>goTo(1));

/* ========= Global inputs/state ========= */
const S = {
  firstName: document.getElementById('firstName'),
  lastName : document.getElementById('lastName'),
  title    : document.getElementById('title'),
  company  : document.getElementById('company'),
  headline : document.getElementById('headline'),
  photo    : document.getElementById('photo'),
  banner   : document.getElementById('banner'),
  phoneBiz : document.getElementById('phoneBiz'),
  phonePersonal: document.getElementById('phonePersonal'),
  emailBiz : document.getElementById('emailBiz'),
  emailPersonal: document.getElementById('emailPersonal'),
  website  : document.getElementById('website'),
  subject  : document.getElementById('subjectLine'),
  logo     : document.getElementById('logo')
};
Object.values(S).forEach(el=>{ if(el) el.addEventListener('input', ()=>updatePreviews()); });

/* ========= Social builder ========= */
const socialOptions = [
  {key:'linkedin_personal', label:'LinkedIn (Personal)'},
  {key:'linkedin_business', label:'LinkedIn (Business)'},
  {key:'facebook', label:'Facebook'},
  {key:'instagram', label:'Instagram'},
  {key:'pinterest', label:'Pinterest'},
  {key:'x', label:'X (Twitter)'},
  {key:'google', label:'Google'},
  {key:'youtube', label:'YouTube'},
  {key:'tiktok', label:'TikTok'}
];
const socials = [];
const socialList = document.getElementById('socialList');
document.getElementById('addSocial')?.addEventListener('click', ()=>{
  socials.push({platform:'linkedin_business', url:''});
  renderSocialRows(); updatePreviews();
});
function renderSocialRows(){
  socialList.innerHTML = '';
  socials.forEach((row, idx)=>{
    const wrap = document.createElement('div');
    wrap.className = 'social-row';
    wrap.innerHTML = `
      <select aria-label="Social platform">
        ${socialOptions.map(opt=>`<option value="${opt.key}" ${opt.key===row.platform?'selected':''}>${opt.label}</option>`).join('')}
      </select>
      <input type="url" placeholder="https://..." value="${row.url || ''}">
      <button class="remove" title="Remove"><svg width="16" height="16" viewBox="0 0 24 24"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
    `;
    const sel = wrap.querySelector('select');
    const input = wrap.querySelector('input');
    const btn = wrap.querySelector('button.remove');
    sel.addEventListener('change', (e)=>{ socials[idx].platform = e.target.value; updatePreviews(); });
    input.addEventListener('input', (e)=>{ socials[idx].url = e.target.value.trim(); updatePreviews(); });
    btn.addEventListener('click', ()=>{ socials.splice(idx,1); renderSocialRows(); updatePreviews(); });
    socialList.appendChild(wrap);
  });
}

/* ========= Image uploads → data URLs ========= */
let photoUrl='', bannerUrl='', logoUrl='';
const photoThumb = document.getElementById('photoThumb');
const bannerThumb = document.getElementById('bannerThumb');
const logoThumb  = document.getElementById('logoThumb');
function readToDataURL(file, cb){ const r=new FileReader(); r.onload = e => cb(e.target.result); r.readAsDataURL(file); }
S.photo?.addEventListener('change', ()=>{
  const f=S.photo.files?.[0]; if(!f) return;
  readToDataURL(f, url=>{ photoUrl = url; if(photoThumb){ photoThumb.style.display='block'; photoThumb.style.backgroundImage = `url('${url}')`; } updatePreviews(); });
});
S.banner?.addEventListener('change', ()=>{
  const f=S.banner.files?.[0]; if(!f) return;
  readToDataURL(f, url=>{ bannerUrl = url; if(bannerThumb){ bannerThumb.style.display='block'; bannerThumb.style.backgroundImage = `url('${url}')`; } updatePreviews(); });
});
S.logo?.addEventListener('change', ()=>{
  const f=S.logo.files?.[0]; if(!f) return;
  readToDataURL(f, url=>{ logoUrl = url; if(logoThumb){ logoThumb.style.display='block'; logoThumb.style.backgroundImage = `url('${url}')`; } if(phoneModalOpen) renderMail(); });
});

/* ========= Icons & helpers ========= */
function i16(name){
  switch (name) {


case 'phone': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M22 16.9v3a2 2 0 0 1-2.2 2A19.8 19.8 0 0 1 3.1 5.3 2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.7c.1.8.3 1.6.6 2.4a2 2 0 0 1-.5 2L8.1 9.9a16 16 0 0 0 6 6l1.5-1.1a2 2 0 0 1 2.1-.5c.8.3 1.6.5 2.4.6A2 2 0 0 1 22 16.9z"/>
  </svg>`;

case 'mail': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <rect x="3" y="5" width="18" height="14" rx="2"/>
    <path d="M3 7l9 6 9-6"/>
  </svg>`;

case 'link': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <!-- left chain -->
    <path d="M8.5 14.5l-1 1a4.5 4.5 0 1 1-6.4-6.4l1-1a4.5 4.5 0 0 1 6.4 0"/>
    <!-- right chain -->
    <path d="M15.5 9.5l1-1a4.5 4.5 0 1 1 6.4 6.4l-1 1a4.5 4.5 0 0 1-6.4 0"/>
    <!-- connector -->
    <path d="M9 12h6"/>
  </svg>`;

case 'linkedin': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M4 9h4v11H4z"/>
    <circle cx="6" cy="5" r="2"/>
    <path d="M10 9h4v2a4 4 0 0 1 8 0v9h-4v-8a2 2 0 0 0-4 0v8h-4z"/>
  </svg>`;

case 'youtube': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <!-- body -->
    <path d="M22 12s0-3-.4-4.5A3 3 0 0 0 19.5 5C17.3 4.8 12 4.8 12 4.8s-5.3 0-7.5.2A3 3 0 0 0 2.4 7.5C2 9 2 12 2 12s0 3 .4 4.5A3 3 0 0 0 4.5 19c2.2.2 7.5.2 7.5.2s5.3 0 7.5-.2a3 3 0 0 0 2.1-2.5C22 15 22 12 22 12z"/>
    <!-- centered play triangle as stroke geometry -->
    <path d="M10 9l5 3-5 3z"/>
  </svg>`;

case 'x': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M4 4l16 16M20 4L4 20"/>
  </svg>`;

case 'instagram': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <rect x="3" y="3" width="18" height="18" rx="5"/>
    <circle cx="12" cy="12" r="4"/>
    <circle cx="17" cy="7" r="1"/>
  </svg>`;

case 'facebook': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M18 2h-3a4 4 0 0 0-4 4v3H8v4h3v9h4v-9h3l1-4h-4V6a1 1 0 0 1 1-1h3z"/>
  </svg>`;

case 'pinterest': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <circle cx="12" cy="12" r="10"/>
    <path d="M11 19c.5-3.8 1.8-6 1.8-8 0-1.6-1.2-2.7-2.8-2.7S7.2 9.2 7.2 10.8c0 1.1.6 2.1 1.8 2.5"/>
  </svg>`;

case 'google': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <!-- cleaner G: outer circle arc + crossbar -->
    <path d="M20 12a8 8 0 1 1-2.34-5.66"/>
    <path d="M12 12h8"/>
  </svg>`;

case 'tiktok': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M14 6a5 5 0 0 0 5 5"/>
    <path d="M10 7v8.5a3.5 3.5 0 1 1-3-3.45"/>
  </svg>`;



}

}
function socialIconKey(platform){
  if(platform && platform.startsWith('linkedin')) return 'linkedin';
  return { facebook:'facebook', instagram:'instagram', pinterest:'pinterest', x:'x', google:'google', youtube:'youtube', tiktok:'tiktok' }[platform] || 'link';
}
function safe(v,fallback=''){ return (v||'').trim()||fallback; }
function oxfordList(arr){
  if(arr.length<=1) return arr.join('');
  if(arr.length===2) return `${arr[0]} and ${arr[1]}`;
  return `${arr.slice(0,-1).join(', ')}, and ${arr[arr.length-1]}`;
}

/* ========= Inline vCard (Step 3) & Status ========= */
function inlineRow(iconName, text){
  if(!text) return '';
  return `<div class="v-demo-row"><span class="icon-pill" aria-hidden="true">${i16(iconName)}</span><span>${text}</span></div>`;
}
function renderInlineVcardFromInputs(){
  const host = document.getElementById('vcardInline');
  if(!host) return;
  const name = `${safe(S.firstName.value,'Your')} ${safe(S.lastName.value,'Name')}`.trim();
  const company = safe(S.company.value,'Your Company');
  const title = safe(S.title.value,'Your Title');
  const headline = safe(S.headline.value,'Your Headline');
  const phoneA = safe(S.phoneBiz.value,'');
  const phoneB = safe(S.phonePersonal.value,'');
  const emailA = safe(S.emailBiz.value,'');
  const emailB = safe(S.emailPersonal.value,'');
  const website = safe(S.website.value,'');
  const socialRows = socials.filter(s=>s.url).map(s => inlineRow(socialIconKey(s.platform), s.url)).join('');
  host.innerHTML = `
    <div class="v-demo-banner" id="inlineBanner" style="${bannerUrl?`background-image:url('${bannerUrl}')`:''}"></div>
    <div class="v-demo-headrow">
      <div class="v-demo-photo" id="inlinePhoto" style="${photoUrl?`background-image:url('${photoUrl}')`:''}">
        ${photoUrl?'':'<svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>'}
      </div>
      <button class="v-demo-save">Save Contact</button>
    </div>
    <div class="v-demo-id">
      <div class="v-demo-name" id="inlineName">${name||'Your Name'}</div>
      <div class="v-demo-company" id="inlineCompany">${company}</div>
      <div class="v-demo-title" id="inlineTitle">${title}</div>
      <div class="v-demo-headline" id="inlineHeadline">${headline}</div>
    </div>
    <div class="v-demo-list" id="inlineList">
      ${inlineRow('phone', phoneA)}
      ${inlineRow('phone', phoneB)}
      ${inlineRow('mail',  emailA)}
      ${inlineRow('mail',  emailB)}
      ${inlineRow('link',  website)}
      ${socialRows}
    </div>
  `;
}
function renderStatus(){
  const socialValid = socials.filter(s=>s.url);
  const missing = [];
  if(!(S.firstName.value && S.lastName.value)) missing.push('first & last name');
  if(!(S.phoneBiz.value || S.phonePersonal.value)) missing.push('at least one phone');
  if(!(S.emailBiz.value || S.emailPersonal.value)) missing.push('at least one email');
  if(!photoUrl) missing.push('headshot');
  if(!bannerUrl) missing.push('background image');
  if(!S.title.value) missing.push('title/role');
  if(!S.headline.value) missing.push('headline');
  if(!(S.website.value || socialValid.length>0)) missing.push('website or at least one social link');

  const complete = missing.length===0;
  const status = complete
    ? `✅ <span class="ok">Your digital card is complete</span>`
    : `⚠️ <span class="warn">Your digital card isn’t complete yet</span> — please add ${oxfordList(missing)}.`;
  const statusEl = document.getElementById('cardStatus');
  if(statusEl) statusEl.innerHTML = status;

  const fillBtn = document.getElementById('btnFillInfo');
  if(fillBtn) fillBtn.style.display = complete ? 'none' : 'inline-flex';

  const sum = document.getElementById('sumCard');
  if(sum) sum.textContent = complete ? 'Digital card complete' : 'Digital card incomplete';
}

/* Keep everything live */
function updatePreviews(){
  if(idx===2){ renderInlineVcardFromInputs(); renderStatus(); }
  if(sheet.classList.contains('show')) fillPeekFromInputs();
  if(phoneModalOpen) renderMail();
}

/* ========= Peek sheet ========= */
const sheet = document.getElementById('peekProfileSheet');
const btnClose = document.getElementById('peekProfileClose');
function togglePeek(show){
  sheet.classList.toggle('show', !!show);
  sheet.setAttribute('aria-hidden', show ? 'false' : 'true');
  if(show) fillPeekFromInputs();
}
btnClose?.addEventListener('click', ()=>togglePeek(false));
window.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && sheet.classList.contains('show')) togglePeek(false); });
document.querySelectorAll('[data-peek]').forEach(b=> b.addEventListener('click', ()=>togglePeek(true)));

function peekRow(iconName, text){
  if(!text) return '';
  return `<div class="v-demo-row"><span class="icon-pill" aria-hidden="true">${i16(iconName)}</span><span>${text}</span></div>`;
}
function fillPeekFromInputs(){
  const name = `${safe(S.firstName.value,'Your')} ${safe(S.lastName.value,'Name')}`.trim();
  document.getElementById('peekName').textContent     = name || 'Your Name';
  document.getElementById('peekCompany').textContent  = safe(S.company.value,'Your Company');
  document.getElementById('peekTitle').textContent    = safe(S.title.value,'Your Title');
  document.getElementById('peekHeadline').textContent = safe(S.headline.value,'Your Headline');

  const bannerDiv = document.getElementById('peekDemoBanner');
  const photoDiv  = document.getElementById('peekDemoPhoto');
  bannerDiv.style.backgroundImage = bannerUrl ? `url('${bannerUrl}')` : '';
  if (photoUrl){ photoDiv.style.backgroundImage = `url('${photoUrl}')`; photoDiv.innerHTML=''; }
  else { photoDiv.style.backgroundImage=''; if(!photoDiv.querySelector('svg')) photoDiv.innerHTML='<svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>'; }

  const phoneA = safe(S.phoneBiz.value,''), phoneB = safe(S.phonePersonal.value,'');
  const emailA = safe(S.emailBiz.value,''), emailB = safe(S.emailPersonal.value,'');
  const website = safe(S.website.value,'');
  const socialRows = socials.filter(s=>s.url).map(s => peekRow(socialIconKey(s.platform), s.url)).join('');
  document.getElementById('peekList').innerHTML = `
    ${peekRow('phone', phoneA)}
    ${peekRow('phone', phoneB)}
    ${peekRow('mail',  emailA)}
    ${peekRow('mail',  emailB)}
    ${peekRow('link',  website)}
    ${socialRows}
  `;
}

/* ========= Actions & upgrade modal ========= */
const actionDefs = [
  {key:'email', label:'Send the Contact an Email', locked:false},
  {key:'text', label:'Send the Contact a Text Message', locked:true},
  {key:'task', label:'Assign a Task to Me', locked:true},
  {key:'journey', label:'Add to a Journey', locked:true},
];
const chosenActions = new Set(['email']);
const chipsHost = document.getElementById('actionChips');
const upg = document.getElementById('upgradeModal');
document.getElementById('upgClose')?.addEventListener('click', ()=>upg.classList.remove('show'));
document.getElementById('upgGo')?.addEventListener('click', ()=>{ upg.classList.remove('show'); alert('Navigate to pricing'); });

actionDefs.forEach(a=>{
  const chip = document.createElement('button');
  chip.className='chip'+(chosenActions.has(a.key)?' active':'');
  chip.textContent = a.label + (a.locked?' 🔒':'');
  chip.onclick = ()=>{
    if(a.locked){ upg.classList.add('show'); return; }
    if(chosenActions.has(a.key)) chosenActions.delete(a.key); else chosenActions.add(a.key);
    chip.classList.toggle('active');
  };
  chipsHost.appendChild(chip);
});
document.getElementById('toEmailCfg')?.addEventListener('click', ()=>{
  if(!chosenActions.has('email')) { alert('Select Email to continue.'); return; }
  goTo(5);
});

/* ========= CTA Builder (single-select gating) ========= */
const ctaOptions = [
  {key:'book', label:'Book a Time', type:'link',  labelDefault:'Book a Meeting',     placeholder:'https://cal.com/yourname',         preDefault:'Grab a spot on my calendar:'},
  {key:'email',label:'Send an Email',type:'email', labelDefault:'Email Me',           placeholder:'you@company.com',                 preDefault:'Prefer email?'},
  {key:'call', label:'Call You',     type:'phone', labelDefault:'Call Me',            placeholder:'+1 (555) 123-4567',               preDefault:'Or reach me directly:'},
  {key:'resources',label:'View Free Resources',type:'link',labelDefault:'See Free Resources', placeholder:'https://yourdomain.com/resources', preDefault:'Here are a few free resources:'}
];
const ctaState = {}; ctaOptions.forEach(o=>ctaState[o.key]={on:false,btnLabel:o.labelDefault,dest:'',pre:o.preDefault});

function renderCtaBuilder(){
  const host = document.getElementById('ctaBuilder');
  host.innerHTML = `
    <div class="label">Choose your call-to-action button</div>
    <div style="display:grid;gap:10px">
      ${ctaOptions.map(o=>{
        const st=ctaState[o.key];
        return `
          <div class="card" style="border-style:${st.on?'solid':'dashed'}">
            <div style="display:flex;align-items:center;justify-content:space-between;gap:10px">
              <label style="display:flex;align-items:center;gap:8px;cursor:pointer">
                <input type="checkbox" data-cta="${o.key}" ${st.on?'checked':''}/> <strong>${o.label}</strong>
              </label>
            </div>
            <div style="display:grid;gap:8px;margin-top:10px;opacity:${st.on?1:.6}">
              <div class="split">
                <div>
                  <div class="label">Button label</div>
                  <input type="text" data-cta-label="${o.key}" value="${st.btnLabel}">
                </div>
                <div>
                  <div class="label">Destination (${o.type==='email'?'email':o.type==='phone'?'phone or tel:': 'URL'})</div>
                  <input type="${o.type==='email'?'email':o.type==='phone'?'text':'url'}" placeholder="${o.placeholder}" data-cta-dest="${o.key}" value="${st.dest}">
                </div>
              </div>
              <div>
                <div class="label">Short text (appears above button)</div>
                <textarea data-cta-pre="${o.key}" placeholder="${o.preDefault}">${st.pre||''}</textarea>
              </div>
            </div>
          </div>
        `;
      }).join('')}
    </div>
  `;
  host.querySelectorAll('input[type="checkbox"][data-cta]').forEach(cb=>{
    cb.addEventListener('change', e=>{
      const key = e.target.getAttribute('data-cta');
      const anotherOn = Object.entries(ctaState).some(([k,v])=>v.on && k!==key);
      if(e.target.checked && anotherOn){
        e.target.checked = false;
        upg.classList.add('show'); // gate multiple
        return;
      }
      ctaState[key].on = e.target.checked;
      renderCtaBuilder();
      if(phoneModalOpen) renderMail();
    });
  });
  host.querySelectorAll('input[data-cta-label]').forEach(inp=>{
    inp.addEventListener('input', e=>{ ctaState[e.target.getAttribute('data-cta-label')].btnLabel = e.target.value; if(phoneModalOpen) renderMail(); });
  });
  host.querySelectorAll('input[data-cta-dest]').forEach(inp=>{
    inp.addEventListener('input', e=>{ ctaState[e.target.getAttribute('data-cta-dest')].dest = e.target.value.trim(); if(phoneModalOpen) renderMail(); });
  });
  host.querySelectorAll('textarea[data-cta-pre]').forEach(ta=>{
    ta.addEventListener('input', e=>{ ctaState[e.target.getAttribute('data-cta-pre')].pre = e.target.value; if(phoneModalOpen) renderMail(); });
  });
}
renderCtaBuilder();
document.getElementById('toPersonality')?.addEventListener('click', ()=>{
  const one = Object.values(ctaState).filter(v=>v.on).length===1;
  const done = Object.values(ctaState).some(v=>v.on && v.btnLabel && v.dest);
  if(!one){ alert('Choose exactly one CTA.'); return; }
  if(!done){ alert('Fill out the selected CTA fields.'); return; }
  goTo(6);
});

/* ========= Personas ========= */
const personas = [
  {key:'professional', label:'Professional and Clear'},
  {key:'friendly',     label:'Friendly & Warm'},
  {key:'bold',         label:'Bold & Energetic'},
  {key:'thoughtful',   label:'Thoughtful & Consultative'},
  {key:'innovative',   label:'Innovative and Modern'},
  {key:'reliable',   label:'Reliable and Trustworthy'}
];
let chosenPersona = 'professional';
function renderPersona(){
  const host = document.getElementById('personaPicker');
  host.innerHTML = `
    <div class="chips" role="listbox" aria-label="Brand personality">
      ${personas.map(p=>`<button class="chip ${chosenPersona===p.key?'active':''}" data-persona="${p.key}">${p.label}</button>`).join('')}
    </div>
  `;
  host.querySelectorAll('[data-persona]').forEach(b=>{
    b.addEventListener('click', e=>{
      chosenPersona = e.target.getAttribute('data-persona');
      renderPersona();
    });
  });
}
renderPersona();
document.getElementById('toContent')?.addEventListener('click', ()=>goTo(7));

/* ========= AI Generate (dummy) ========= */
const overlay = document.getElementById('aiOverlay');
const coOverview = document.getElementById('coOverview');
const coMission  = document.getElementById('coMission');
const coValues   = document.getElementById('coValues');
const coDiff     = document.getElementById('coDiff');
const DUMMY = {
  professional: [
    {overview:"Segwik is a human-centered Relationship Operating System that unifies contacts, communication, and workflows so small teams can build consistent, revenue-driving relationships.",
     mission:"To remove operational friction so people can spend more time with customers and less time managing tools.",
     values:"Clarity • Reliability • Customer Empathy • Continuous Improvement",
     diff:"An all-in-one, AI-assisted workspace that replaces scattered tools with one streamlined system."},
    {overview:"We turn scattered pipelines into a single, clear workflow that scales from solopreneurs to growing teams.",
     mission:"Help ambitious businesses communicate faster, follow up smarter, and never drop the ball.",
     values:"Focus • Speed • Accountability • Simplicity",
     diff:"Built-in automations and sensible defaults so adoption is instant—not a six-month project."}
  ]
  ,innovative: [
    {overview:"Segwik is a human-centered Relationship Operating System that unifies contacts, communication, and workflows so small teams can build consistent, revenue-driving relationships.",
     mission:"To remove operational friction so people can spend more time with customers and less time managing tools.",
     values:"Clarity • Reliability • Customer Empathy • Continuous Improvement",
     diff:"An all-in-one, AI-assisted workspace that replaces scattered tools with one streamlined system."}]
  ,reliable: [
    {overview:"Segwik is a human-centered Relationship Operating System that unifies contacts, communication, and workflows so small teams can build consistent, revenue-driving relationships.",
     mission:"To remove operational friction so people can spend more time with customers and less time managing tools.",
     values:"Clarity • Reliability • Customer Empathy • Continuous Improvement",
     diff:"An all-in-one, AI-assisted workspace that replaces scattered tools with one streamlined system."}]
  ,friendly:[{overview:"Segwik helps you keep every convo, task, and relationship in one friendly home—so follow-up finally feels easy.",mission:"Make growing your business feel human again.",values:"Kindness • Transparency • Helpfulness • Joy",diff:"Playful, practical tools that work out of the box—even if you hate CRMs."}]
  ,bold:[{overview:"Segwik is the command center for relationships—cutting noise, speeding action, and growing revenue.",mission:"Destroy busywork. Supercharge follow-up.",values:"Ownership • Momentum • Candor • Craft",diff:"Lightning-fast automations and a clean UI that ship wins on day one."}]
  ,thoughtful:[{overview:"Segwik brings structure to relationship-building with unobtrusive automation and clear, shared context.",mission:"Elevate the quality and consistency of every customer interaction.",values:"Empathy • Rigor • Stewardship • Learning",diff:"A pragmatic platform that meets teams where they are and grows with them."}]
};
let dummyIdx=0;
function fillFromDummy(){
  const set = DUMMY[chosenPersona][dummyIdx % DUMMY[chosenPersona].length];
  coOverview.value=set.overview; coMission.value=set.mission; coValues.value=set.values; coDiff.value=set.diff; dummyIdx++;
}
function withLoader(fn){ overlay.classList.add('show'); setTimeout(()=>{ fn(); overlay.classList.remove('show'); if(phoneModalOpen) renderMail(); }, 800); }
document.getElementById('genAI')?.addEventListener('click', ()=>withLoader(fillFromDummy));
document.getElementById('regenAI')?.addEventListener('click', ()=>withLoader(fillFromDummy));

/* ========= Subject / Logo step nav ========= */
document.getElementById('toLogo')?.addEventListener('click', ()=>goTo(8));
document.getElementById('finish')?.addEventListener('click', ()=>goTo(9));

/* ========= Phone-styled Email Preview ========= */
let phoneModalOpen = false;
const phoneModal = document.getElementById('phonePreview');
function togglePhone(show){
  phoneModal.classList.toggle('show', !!show);
  phoneModal.setAttribute('aria-hidden', show ? 'false' : 'true');
  phoneModalOpen = !!show;
  if(show) { syncPhoneTitle(); renderMail(); }
}
document.getElementById('phoneClose')?.addEventListener('click', ()=>togglePhone(false));
document.getElementById('peekEmail1')?.addEventListener('click', ()=>togglePhone(true));
document.getElementById('peekEmail2')?.addEventListener('click', ()=>togglePhone(true));

function syncPhoneTitle(){ document.getElementById('phoneTitle').textContent = safe(S.subject?.value, "It’s great to be connected!"); }

function activeCTA(){
  const entry = Object.entries(ctaState).find(([k,v])=>v.on && v.btnLabel && v.dest);
  if(!entry) return null;
  const [k,v]=entry; const def = ctaOptions.find(o=>o.key===k);
  return {key:k, ...def, ...v};
}
function socialButtons(){
  return socials.filter(s=>s.url).map(s=>{
    const key=socialIconKey(s.platform);
    return `<a href="${s.url}" target="_blank" rel="noopener" aria-label="${key}">${i16(key)}</a>`;
  }).join('');
}
function buildCTA(a){
  if(!a) return '';
  let href='#', target='_self';
  if(a.type==='link'){ href=a.dest; target='_blank';}
  if(a.type==='email'){ href=`mailto:${a.dest}`;}
  if(a.type==='phone'){ href=`tel:${a.dest.replace(/[^+\d]/g,'')}`;}
  const pre = a.pre ? `<p>${a.pre}</p>` : '';
  const cls = a.key==='book' ? 'cta blue' : 'cta';
  return `${pre}<div style="margin:8px 0 12px 0"><a class="${cls}" href="${href}" target="${target}" rel="noopener">${a.btnLabel}</a></div>`;
}
function renderMail(){
  const host = document.getElementById('mailPreview');
  const subj = safe(S.subject?.value, "It’s great to be connected!");
  const a = activeCTA();
  const logo = logoUrl ? `<div style="text-align:center;margin-bottom:10px"><img src="${logoUrl}" alt="logo" style="max-width:160px;max-height:60px;object-fit:contain"/></div>` : '';

  const signature = `
    <div class="sig">
      ${photoUrl?`<img src="${photoUrl}" alt="headshot">`:''}
      <div class="meta">
        <div class="name">${safe(S.firstName?.value,'[First]')} ${safe(S.lastName?.value,'[Last]')}</div>
        <div>${safe(S.company?.value,'[Company]')}</div>
        ${safe(S.emailBiz?.value,'')?`<div>${S.emailBiz.value}</div>`:''}
        ${safe(S.phoneBiz?.value,'')?`<div>${S.phoneBiz.value}</div>`:''}
        ${socials.length?`<div class="socials">${socialButtons()}</div>`:''}
      </div>
    </div>`;

  host.innerHTML = `
    <div class="mail-topbar"><div class="subject">${subj}</div></div>
    <div class="mail-body">
      ${logo}
      <p>Hello [firstname], thanks for downloading my digital business card — I’m excited we crossed paths. Let me introduce myself a bit more:</p>

      <p style="font-weight:800;margin-top:12px">About My Business</p>
      <p>${safe(coOverview?.value,'[company_overview]')}</p>

      <p style="font-weight:800;margin-top:12px">What Drives Us</p>
      <p>${safe(coMission?.value,'[mission_statement]')}</p>

      <p style="font-weight:800;margin-top:12px">What Makes Us Different</p>
      <p>${safe(coDiff?.value,'[organization_values]')}</p>

      <p style="font-weight:800;margin-top:12px">Our Core Values</p>
      <p>${safe(coValues?.value,'[differentiating_propositions]')}</p>

      ${buildCTA(a)}
      ${signature}
    </div>
  `;
}

/* ========= Buttons & Summary Toggle ========= */
document.getElementById('btnPreviewCard')?.addEventListener('click', ()=>alert('Mock: Opening public vCard link'));
document.getElementById('btnFillInfo')?.addEventListener('click', ()=>goTo(1));
document.getElementById('seeExamples')?.addEventListener('click', ()=>{ alert('Mock: shows a gallery of sample vCards.'); });

const toggle = document.getElementById('toggle');
toggle?.addEventListener('click', ()=>{
  const on = toggle.classList.toggle('on');
  toggle.setAttribute('aria-checked', on ? 'true' : 'false');
  alert(on ? 'Journey activated' : 'Journey deactivated');
});

/* ========= Init ========= */
renderSocialRows();
renderCtaBuilder();
renderPersona();
goTo(0);
updatePreviews();
syncPhoneTitle();
</script>
</body>
</html>
