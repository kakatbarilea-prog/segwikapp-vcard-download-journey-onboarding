
<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0">
<title>Segwik Mobile ‚Äì vCard ‚Üí Download Journey Onboarding</title>
<style>
  :root{
    --bg:#f6f8fb; --ink:#243048; --muted:#667085; --line:#e6ebf2;
    --accent:#0F2D56; --blue:#2563eb; --blue-700:#1d4ed8; --blue-50:#eef2ff;
    --card:#fff; --radius:16px; --shadow:0 14px 38px rgba(0,0,0,.08);
    --phone-w:430px; --phone-h:800px; --footer-h:48px; --status-h:46px;
    --nav-safe: 140px; --green:#22c55e;
  }
  *{box-sizing:border-box}
  html,body{height:100%;margin:0;display:grid;place-items:center;background:var(--bg);color:var(--ink);font-family:Segoe UI,system-ui,-apple-system,sans-serif}
  svg{stroke:currentColor;fill:none;stroke-width:2;stroke-linecap:round;stroke-linejoin:round}
  .phone{width:var(--phone-w);height:var(--phone-h);background:#fff;border-radius:36px;border:8px solid #111;overflow:hidden;display:flex;flex-direction:column;box-shadow:0 20px 60px rgba(0,0,0,.12),0 8px 16px rgba(0,0,0,.08);position:relative}
  .notch{position:absolute;top:8px;left:50%;transform:translateX(-50%);width:180px;height:30px;background:#111;border-radius:20px 20px 28px 28px;z-index:10}
  .status{height:var(--status-h);display:flex;align-items:center;justify-content:center;border-bottom:1px solid var(--line);font-weight:800;color:var(--accent)}
  .screen{flex:1;position:relative;background:var(--bg);height:calc(100% - var(--status-h) - var(--footer-h));overflow:hidden}
  .tray{display:grid;grid-template-columns:repeat(5,1fr);gap:8px;padding:8px;border-top:1px solid var(--line);background:#fff}
  .ibtn{padding:8px;border:1px solid var(--line);border-radius:12px;background:#f8fafc;display:grid;place-items:center}
  .btn{appearance:none;border:1px solid var(--line);background:#fff;color:var(--accent);padding:10px 14px;border-radius:12px;font-weight:800;cursor:pointer;display:inline-flex;align-items:center;gap:8px}
  .btn.blue{background:var(--blue);border-color:var(--blue);color:#fff}
  .btn.blue:hover{background:var(--blue-700);border-color:var(--blue-700)}
  .btn.ghost{background:#f8fafc}
  .btn.small{padding:8px 10px;border-radius:10px;font-size:12px}
  .btn.full{width:100%}
  .chips{display:flex;flex-wrap:wrap;gap:8px}
  .chip{border:1px solid var(--line);background:#fff;border-radius:999px;padding:8px 12px;font-weight:700;cursor:pointer}
  .chip.active{background:#eff6ff;border-color:#c7d2fe}

  /* ==== Brand Personality (new UI) ==== */
.group{display:flex;flex-direction:column;gap:8px}
.group h3{margin:0;font-size:14px;color:var(--accent);font-weight:900}
.group .help{font-size:12px;color:var(--muted)}
.grid-2{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.grid-1{display:grid;grid-template-columns:1fr;gap:8px}
/* Tone: fixed two-column grid */
.chips.twocol{display:grid;grid-template-columns:1fr 1fr;gap:8px}
.chips.twocol .chip{width:100%; text-align:left}

/* Right-aligned small link under Tone chips */
.more{display:flex; justify-content:flex-end; margin-top:2px}
.more .btn.small{font-weight:700}


/* radio-style chip (single-select) */
.chip.radio{position:relative;padding-left:36px}
.chip.radio::before{
  content:""; position:absolute; left:12px; top:50%; transform:translateY(-50%);
  width:14px; height:14px; border:2px solid #cfd7e7; border-radius:50%; background:#fff;
}
.chip.radio.active::before{
  border-color:var(--blue); box-shadow:inset 0 0 0 4px #fff, 0 0 0 2px var(--blue);
}

/* scroll helper (only this step may be long) */
.bp-step .scroll{padding-bottom:calc(var(--nav-safe) + 8px); overflow:auto}


  .carousel{height:100%;display:flex;transition:transform .32s cubic-bezier(.22,.61,.36,1);will-change:transform}
  .slide{min-width:100%;height:100%;padding:14px;display:flex;flex-direction:column}
  .head{padding:6px 2px 8px}
  .h1{font-weight:900;color:var(--accent);font-size:18px}
  .p{font-size:13px;color:var(--muted);line-height:1.5}
  .scroll{flex:1;min-height:0;overflow:auto;display:flex;flex-direction:column;gap:12px;padding-bottom:var(--nav-safe)}
  .card{background:#fff;border:1px solid var(--line);border-radius:var(--radius);box-shadow:var(--shadow);padding:14px}
  .label{font-size:12px;color:var(--muted);font-weight:800;margin-bottom:6px}
  input[type="text"],input[type="email"],input[type="url"],textarea{width:100%;padding:10px 12px;border:1px solid var(--line);border-radius:12px;background:#f8fafc;font:inherit}
  /* On-brand selects */
select{
  width:100%;
  padding:10px 36px 10px 12px;
  border:1px solid var(--line);
  border-radius:12px;
  background:#f8fafc;
  font:inherit;
  appearance:none;
  -webkit-appearance:none;
  -moz-appearance:none;
  background-image: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="%23667085" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="6 9 12 15 18 9"/></svg>');
  background-repeat:no-repeat;
  background-position:right 10px center;
  background-size:18px;
}

/* Headline textarea should be ~2 lines tall (override global textarea min-height) */
textarea#headline{
  min-height:60px; /* ~2 lines */
}

  textarea{min-height:110px;resize:vertical}
  .split{display:grid;grid-template-columns:1fr 1fr;gap:10px}

  .nav{position:absolute;left:0;right:0;bottom:var(--footer-h);display:flex;justify-content:space-between;gap:8px;padding:0 14px;z-index:5}
  .pager{position:absolute;left:0;right:0;bottom:calc(var(--footer-h) + 42px);display:flex;justify-content:center;gap:6px;pointer-events:auto;z-index:5}
  .dot{width:8px;height:8px;border-radius:50%;background:#c9d2e4;opacity:.9;cursor:pointer}
/* default active dot (except the Finish one) */
.dot.active:not(.finish){
  background: var(--accent);
}

/* Finish dot gets Segwik blue when active */
.dot.finish.active{
  background: var(--blue);
}
 

  /* vCard tiles in the inline/peek previews */
  .vcard{border:1px solid #e6ebf2;border-radius:18px;overflow:hidden}
  .v-banner{position:relative;height:180px;background:#dbe6ff url('https://images.unsplash.com/photo-1551817958-d33c6c9f24a1?q=80&w=1200&auto=format&fit=crop') center/cover}
  .v-banner::after{content:"";position:absolute;inset:0;background:linear-gradient(to bottom, rgba(0,0,0,.25), rgba(0,0,0,0) 50%)}
  .v-save{position:absolute;right:14px;bottom:-22px}
  .v-head{display:flex;gap:12px;align-items:flex-end;padding:28px 14px 12px}
  .v-photo{width:84px;height:84px;border-radius:50%;border:3px solid #fff;background:#e5edf8;background-size:cover;background-position:center;box-shadow:0 4px 12px rgba(0,0,0,.12)}
  .v-name{font-weight:900;font-size:20px;margin:6px 0 2px}
  .v-company{font-weight:700;color:#0b1220}
  .v-headline{color:#6a768f;margin-top:6px}
  .v-list{padding:8px 14px 16px;display:grid;gap:12px}
  .v-row{display:flex;gap:10px;align-items:flex-start}
  .vcard .v-row .ico{width:22px;height:22px;border-radius:50%;display:grid;place-items:center;background:#000;color:#fff;flex:0 0 22px}
  .vcard .v-row .ico svg,.vcard .v-row .ico svg *{stroke:#fff !important;fill:none !important;width:14px;height:14px;display:block}

  /* Phone-styled email preview */
  .phone-modal{ position:absolute; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:3200; }
  .phone-modal.show{ display:flex; }
  .phone-frame{ width:360px; max-width:92vw; background:#fff; border:1px solid #e5e7eb; border-radius:18px; box-shadow:0 20px 60px rgba(0,0,0,.18); overflow:hidden; }
  .phone-titlebar{ display:flex; gap:6px; align-items:center; padding:10px; background:#f9fafb; border-bottom:1px solid #eef1f6; }
  .dot-r{width:10px;height:10px;border-radius:50%;background:#ef4444}
  .dot-o{width:10px;height:10px;border-radius:50%;background:#f59e0b}
  .dot-g{width:10px;height:10px;border-radius:50%;background:#22c55e}
  .email-preview{ max-height:60vh; overflow:auto; }
  .mail-frame{border:0;border-radius:0;background:#fff}
  .mail-topbar{display:flex;justify-content:flex-start;align-items:center;padding:10px 12px;border-bottom:1px solid #eef1f6}
  .mail-topbar .subject{font-weight:800}
  .mail-body{padding:14px;line-height:1.55}
  .mail-body p{margin:0 0 10px 0}
  .sig{display:flex; gap:12px; align-items:flex-start; margin-top:14px; border-top:1px solid #eef1f6; padding-top:12px;}
  .sig img{width:48px;height:48px;border-radius:50%;object-fit:cover;border:2px solid #fff;box-shadow:0 2px 6px rgba(0,0,0,.06)}
  .sig .meta{font-size:13px;color:#334155}
  .sig .meta .name{font-weight:800;color:#111827}
  .sig .socials{display:flex;gap:8px;margin-top:6px}

  /* Upgrade modal */
  .modal-wrap{ position:absolute; inset:0; background:rgba(0,0,0,.35); display:none; align-items:center; justify-content:center; z-index:3000; }
  .modal-wrap.show{ display:flex; }
  .modal{ background:#fff; border:1px solid var(--line); border-radius:16px; box-shadow:var(--shadow); width:92%; max-width:380px; padding:16px; }
  .modal h3{ margin:0 0 8px 0; font-size:16px; color:var(--accent); }
  .modal p{ margin:0 0 12px 0; color:var(--muted); }
  .modal .row{ display:flex; gap:8px; justify-content:flex-end; }

  .setup-image{ display:block; width:auto; height:360px; margin:0 auto 16px; border-radius:8px; object-fit:contain; }

/* Bridge screen image (adjust size here) */
.bridge-image{
  display:block;
  width:340px;
  height:auto;     /* ‚Üê adjust this height to change image size */
  margin:0 auto 16px;
  border-radius:8px;
  object-fit:contain;
}
/* Entry Confirm GIF (adjust size here) */
.entry-gif{
  display:block;
  width:auto;
  height:350px;   /* ‚Üê adjust this height to change the GIF size */
  object-fit:cover;
  border-radius:8px;
  margin:10px 0 8px;
}


  .uploader{ display:grid; grid-template-columns:1fr 1fr; gap:10px; }
  .drop{ border:2px dashed #bfd3ff; background:#f5f8ff; color:#0F2D56; padding:14px; border-radius:14px; cursor:pointer; display:flex; gap:12px; align-items:center; transition:.18s ease; position:relative; min-height:74px; }
  .drop:hover{ background:#eef4ff; border-color:#9ab8ff; }
  .drop:active{ background:#e5eeff; }
  .drop .ico{ width:40px; height:40px; border-radius:10px; background:#fff; display:grid; place-items:center; border:1px solid #e6ebf2; }
  .drop .txt{ font-size:12px; line-height:1.35; }
  .drop .txt b{ display:block; font-size:13px; }
  .drop input[type="file"]{ position:absolute; inset:0; opacity:0; cursor:pointer; }
  .thumb{ position:absolute; right:10px; top:10px; width:48px; height:48px; border-radius:12px; border:1px solid #e6ebf2; background:#fff center/cover no-repeat; box-shadow:0 2px 6px rgba(0,0,0,.06); }

  .social-row{display:grid; grid-template-columns:160px 1fr 36px; gap:8px; align-items:center}
  .social-row select, .social-row input{padding:10px 12px; border:1px solid var(--line); background:#f8fafc; border-radius:10px; font:inherit}
  .social-row .remove{appearance:none; border:1px solid var(--line); background:#fff; border-radius:10px; width:36px; height:36px; display:grid; place-items:center; cursor:pointer}
  .social-add{margin-top:10px}
  .peek-trigger{display:inline-flex; align-self:flex-end}

  /* AI loader */
  .ai-overlay{position:absolute; inset:0; background:rgba(255,255,255,.8); display:none; align-items:center; justify-content:center; z-index:2500; font-weight:800; color:#0F2D56;}
  .ai-overlay.show{display:flex;}

  /* Toggle */
  .switch{position:relative;width:56px;height:30px;background:#e5e7eb;border-radius:999px;cursor:pointer;transition:.18s ease;border:1px solid #d1d5db}
  .switch.on{background:var(--green);border-color:var(--green)}
  .knob{position:absolute;top:3px;left:3px;width:24px;height:24px;background:#fff;border-radius:50%;box-shadow:0 1px 3px rgba(0,0,0,.2);transition:.18s ease}
  .switch.on .knob{left:29px}

  /* ==== Peek sheet ==== */
  .peeksheet-wrap{ position:absolute; inset:0; background:rgba(15,45,86,.28); display:none; align-items:flex-end; z-index:2000; }
  .peeksheet-wrap.show{ display:flex; }
  .peeksheet{
    width:100%; height:calc(100% - 6px); max-height:100%;
    background:#fff; border-top:1px solid var(--line);
    border-radius:24px 24px 0 0; box-shadow:var(--shadow);
    padding:0; display:flex; flex-direction:column;
    transform:translateY(100%); animation:peekSlideUp .25s ease forwards;
  }
  @keyframes peekSlideUp{ to{ transform:translateY(0) } }
  .peeksheet-top{
    display:flex; align-items:center; justify-content:space-between; gap:8px;
    padding:14px 16px; border-bottom:1px solid var(--line); background:#fff;
    position:sticky; top:0; z-index:1;
  }
  .peeksheet-title{ font-weight:900; color:var(--accent); }
  .peeksheet-close{
    appearance:none; border:0; background:#f8fafc; border:1px solid var(--line);
    border-radius:10px; padding:6px 10px; cursor:pointer; font-size:18px; line-height:1;
  }
  .peeksheet-body{ flex:1; overflow:auto; -webkit-overflow-scrolling:touch; padding:14px 16px 22px; }

  /* Demo vCard inside the sheet (exact look) */
  .vcard-demo{ width:100%; border:1px solid #e6ebf2; border-radius:18px; overflow:hidden; background:#fff; box-shadow:var(--shadow); }
  .v-demo-banner{ height:180px; background:#eef2f7; background-size:cover; background-position:center; }
  .v-demo-headrow{ display:flex; align-items:flex-end; gap:12px; padding:18px 14px 8px; }
  .v-demo-photo{
    width:84px; height:84px; border-radius:50%; border:3px solid #fff;
    background:#e9edf3; display:grid; place-items:center; color:#9aa4b2;
    box-shadow:0 4px 12px rgba(0,0,0,.08);
    background-size:cover; background-position:center;
  }
  .v-demo-photo svg{ width:30px; height:30px; }
  .v-demo-save{
    margin-left:auto; margin-bottom:6px; appearance:none; border:0;
    background:#2563eb; color:#fff; padding:10px 14px; border-radius:14px; font-weight:800;
  }
  .v-demo-id{ line-height:1.45; padding:0 14px 10px; }
  .v-demo-name{ font-weight:900; font-size:20px; color:#0b1220; }
  .v-demo-company{ color:#263043; font-weight:700; }
  .v-demo-title{ color:#111827; font-weight:800; }
  .v-demo-headline{ color:#6b7280; }

  .v-demo-list{ padding:10px 14px 18px; display:grid; gap:14px; }
  .v-demo-row{ display:flex; gap:10px; align-items:center; color:#1f2937; }
  .icon-pill{ width:28px; height:28px; border-radius:50%; background:#000; display:grid; place-items:center; }
  .icon-pill svg{ width:14px; height:14px; stroke:#fff; fill:none; stroke-width:2; }

  .peek-trigger{ display:inline-flex; align-self:flex-end; }
  /* Green badge used on the pause screen */
.badge {
  display:inline-flex; align-items:center; gap:8px;
  font-weight:900; color:#064e3b; background:#dcfce7;
  border:1px solid #bbf7d0; border-radius:999px; padding:6px 10px;
}
.badge .dot { width:8px; height:8px; border-radius:50%; background:var(--green); }

/* Stack chips one-per-row */
.chips.stacked{
  flex-direction:column;
  align-items:flex-start;
  justify-content:flex-start;
}
.chips.stacked .chip{
  width:100%;
  justify-content:flex-start;
  text-align:left;
}


#actionChips .chip { text-align: left; }


/* Form preview (inside peek sheet) */
.form-preview{ padding:6px 0 }
.form-preview .big-title{
  display:flex; align-items:center; gap:8px; font-weight:900; color:#0F2D56; margin-bottom:6px;
}
.form-preview .big-title .ok{ color:#22c55e; }
.form-preview .sub{ color:#667085; margin-bottom:12px; }
.form-preview .hint{ font-size:12px; color:#667085; margin:6px 0 10px; }
.form-preview .row{ display:grid; gap:8px; }
.form-preview .row .intl-phone{ display:grid; grid-template-columns:80px 1fr; gap:8px; }
.form-preview .submit{ width:100%; padding:12px 14px; border-radius:999px; border:0; font-weight:800; color:#fff; background:#d1d5db; cursor:not-allowed }
.form-preview a{ color:#2563eb; text-decoration:underline; cursor:pointer }


/* Email templates list */
.templates{display:grid; gap:8px}
.template-row{
  display:flex; align-items:center; justify-content:space-between; gap:8px;
  padding:8px 10px; border:1px solid var(--line); border-radius:10px; background:#fff;
}
.template-row .name{font-weight:400; color:var(--accent)}
.template-row .actions{display:flex; gap:6px}
.template-row .eye{appearance:none; border:1px solid var(--line); background:#f8fafc;
  border-radius:8px; padding:6px; display:grid; place-items:center; cursor:pointer}
.template-row.active{border-color:#9ab8ff; background:#f5f8ff}
.add-template{margin-top:12px; color:#2563eb; cursor:pointer; text-align:left; font-size:14px;}

/* CTA button (rendered before footer in email preview) */
.cta-btn{
  display:inline-block;
  padding:12px 16px;
  border-radius:999px;
  background:#2563eb;
  color:#fff;
  font-weight:800;
  text-decoration:none;
  border:1px solid #1d4ed8;
}
.cta-btn:hover{ background:#1d4ed8 }


/* ===== Step 5 (Final Check) ===== */
/* Header row: label on left, button on right */
.label-row{
  display:flex; align-items:center; justify-content:space-between; gap:12px;
}
.label-row .label{ margin:0; }

/* Use the same phone look INSIDE the card */
.phone-frame.final {
  width:100%;
  max-width:100%;
  background:#fff;
  border:1px solid #e5e7eb;
  border-radius:14px;
  box-shadow:var(--shadow);
  overflow:hidden;
}
.phone-titlebar.final {
  display:flex; gap:6px; align-items:center;
  padding:10px; background:#f9fafb; border-bottom:1px solid #eef1f6;
}
.email-preview.final { max-height:420px; overflow:auto; }

/* push confirmation stays the same look */
.push {
  position:sticky; top:-14px; margin:-14px -14px 12px -14px;
  background:#ecfeff; color:#0f766e; border:1px solid #a5f3fc;
  border-radius:12px; padding:10px 12px; font-weight:800; display:none;
}
.push.show{ display:block; }

/* the button used beside the label */
#sendTestBtn{
  appearance:none; border:1px solid var(--line); background:#eef4ff;
  color:#0F2D56; border-radius:10px; padding:6px 10px; font-weight:700; cursor:pointer;
}

/* "+ Add more follow-ups" link (reuse same style as others) */
.add-template:hover{ text-decoration:underline; }

.label {
  font-weight: 400; /* normal weight, not bold */
}

.link-text{
  font-size:13px;
  color:var(--blue);
  cursor:pointer;
  text-decoration:underline;
  font-weight:600;
  user-select:none;
}
.link-text:hover{
  text-decoration:none;
}
/* Make textareas expand automatically when typing */
textarea {
  overflow: hidden;
  resize: none; /* optional: removes manual drag handle */
  min-height: 300px;
  transition: height 0.2s ease;
}



</style>
</head>
<body>
  <div class="phone">
    <div class="notch"></div>
    <div class="status"></div>

    <div class="screen">
      <div id="carousel" class="carousel">

        <!-- Step 0: Welcome -->
        <section class="slide">
          <div class="head">
            <div class="h1">Let‚Äôs build your account profile.</div>
            <div class="p">This profile helps personalize your Segwik experience and keeps your information consistent across your journeys and automations</div>
          </div>

          <div class="scroll" style="overflow:hidden">

            <div class="card">
              <img src="https://d34hmiuaex7c0.cloudfront.net/2952/uploads/cmaspages/gallery/galleryitem_1760702903557.png" alt="vCard setup preview" class="setup-image"/>
              <div class="p" style="margin-bottom:12px">
                Please snap a pic of your business card, front and back.

              </div>
              <div class="row">
                <button id="skip" class="btn">Skip</button>
                <button id="startCard" class="btn blue" style="margin-left:auto">Save & Continue</button>
              </div>
            </div>
          </div>
        </section>

        <!-- Step: vCard ‚Äî Profile -->
        <section class="slide">
          <div class="head">
            <div class="h1">Confirm Profile Details</div>
            <div class="p">This will be part of your digital business card, helping you look great and show up professionally when you meet new people.</div>
          </div>
          <div class="scroll">
            <div class="card">
              <div class="split">
                <div>
                  <div class="label">First Name</div>
                  <input id="firstName" type="text" placeholder="">
                </div>
                <div>
                  <div class="label">Last Name</div>
                  <input id="lastName" type="text" placeholder="">
                </div>
              </div>
              <div class="split" style="margin-top:10px">
                <div>
                  <div class="label">Title / Role</div>
                  <input id="title" type="text" placeholder="">
                </div>
                <div>
                  <div class="label">Company Name</div>
                  <input id="company" type="text" placeholder="">
                </div>
              </div>
              <!-- NEW: Industry / Sub Industry -->
<div class="split" style="margin-top:10px">
  <div>
    <div class="label">Industry</div>
    <select id="industry">
      <option value="">Select industry‚Ä¶</option>
      <option>Technology</option>
      <option>Real Estate</option>
      <option>Financial Services</option>
      <option>Healthcare</option>
      <option>Marketing & Advertising</option>
      <option>Education</option>
      <option>Legal</option>
      <option>Hospitality</option>
      <option>Construction</option>
      <option>Manufacturing</option>
      <option>Retail & E-commerce</option>
      <option>Nonprofit</option>
      <option>Other</option>
    </select>
  </div>
  <div>
    <div class="label">Sub Industry</div>
    <select id="subIndustry">
      <option value="">Select sub industry‚Ä¶</option>
      <option>Consulting</option>
      <option>SaaS</option>
      <option>Insurance</option>
      <option>Mortgage</option>
      <option>Residential</option>
      <option>Commercial</option>
      <option>Medical Devices</option>
      <option>Therapy & Wellness</option>
      <option>Coaching</option>
      <option>Agency</option>
      <option>Training</option>
      <option>Services</option>
      <option>Other</option>
    </select>
  </div>
</div>

<!-- Headline as a 2-line textarea -->
<div style="margin-top:10px">
  <div class="label">Headline</div>
  <textarea id="headline" placeholder="Share What You‚Äôre Known For" rows="2"></textarea>
</div>

            </div>

          

            <!-- Bottom of step: peek trigger <button class="btn peek-trigger" data-peek>üëÅ Where will this appear?</button> -->
          </div>
        </section>

        <!-- Step: vCard ‚Äî Contact -->
<section class="slide">
  <div class="head">
    <div class="h1">Confirm Contact Details</div>
    <div class="p">This will appear in your digital business card ‚Äî a simple way to make sure you always show up polished and professional.</div>
  </div>
  <div class="scroll">

    <div class="card">
      <div class="label">Phones</div>
      <div class="split">
        <div><input id="phoneBiz" type="text" placeholder="Business Phone"></div>
        <div><input id="phonePersonal" type="text" placeholder="Personal Phone"></div>
      </div>
      <div class="label" style="margin-top:10px">Emails</div>
      <div class="split">
        <div><input id="emailBiz" type="email" placeholder="Business Email"></div>
        <div><input id="emailPersonal" type="email" placeholder="Personal Email"></div>
      </div>
      <div style="margin-top:10px">
        <div class="label">Website</div>
        <input id="website" type="url" placeholder="https://">
      </div>
    </div>

    <!-- Bottom of step: peek trigger <button class="btn peek-trigger" data-peek>üëÅ Where will this appear?</button>-->
    
  </div>
</section>

<!-- Step: Logo upload -->
        <section class="slide" data-step="logo">
          <div class="head">
            <div class="h1">Do you have a logo?</div>
            <div class="p">Your logo helps people instantly recognize your brand.</div>
          </div>
          <div class="scroll">
            

            <div class="card">
              <div class="uploader" style="grid-template-columns:1fr">
                <label class="drop" id="logoDrop">
                  <span class="ico"><svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></span>
                  <span class="txt"><b>Upload Logo</b>PNG with transparent background works best</span>
                  <input id="logo" type="file" accept="image/*">
                  <span class="thumb" id="logoThumb" aria-hidden="true" style="display:none"></span>
                </label>
              </div>
            </div>

            <!-- <button id="peekEmail2" class="btn">See Example Placement</button>-->

            
          </div>
        </section>

    <!-- Step: Brand Personality (ONE SCREEN ‚Äì MULTISELECT) -->
<section class="slide bp-step" data-step="bp-all">
  <div class="head">
    <div class="h1">How do you see yourself in the market?</div>
    <div class="p">Select all that describe your brand personality.</div>
  </div>
  <div class="scroll">
    <div class="card" id="brandPersonalityAll">
      <div class="group">
        <h3>1) Sincerity</h3>
        <div class="help">Select all that apply</div>
        <div class="chips twocol" id="bpSincerity"></div>
      </div>
      <div class="group" style="margin-top:12px">
        <h3>2) Excitement</h3>
        <div class="help">Select all that apply</div>
        <div class="chips twocol" id="bpExcitement"></div>
      </div>
      <div class="group" style="margin-top:12px">
        <h3>3) Competence</h3>
        <div class="help">Select all that apply</div>
        <div class="chips twocol" id="bpCompetence"></div>
      </div>
      <div class="group" style="margin-top:12px">
        <h3>4) Sophistication</h3>
        <div class="help">Select all that apply</div>
        <div class="chips twocol" id="bpSophistication"></div>
      </div>
      <div class="group" style="margin-top:12px">
        <h3>5) Ruggedness</h3>
        <div class="help">Select all that apply</div>
        <div class="chips twocol" id="bpRuggedness"></div>
      </div>
    </div>
  </div>
</section>



        <!-- Step: Content + AI generate (SPLIT INTO 4 SCREENS) -->
<!-- Screen 1: Overview -->
<section class="slide" data-step="content1">
  <div class="head">
    <div class="h1">Tell us about your business</div>
    <div class="p">You can write your own or let AI draft and then edit.</div>
  </div>
  <div class="scroll" style="position:relative">
    <div class="ai-overlay" id="aiOverlay">Generating your copy‚Ä¶</div>

    <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-self:flex-start">
      <button data-regen class="btn">Regenerate with Segwik AI</button>
    </div>

    <div class="card">
      <div class="label">Is this a good overview of your business?</div>
      <textarea id="coOverview" placeholder="Describe what your company does‚Ä¶"></textarea>
    </div>

  <!--   <button id="peekEmail1" class="btn">See Example Placement</button> -->
  </div>
</section>

<!-- Screen 2: Mission -->
<section class="slide" data-step="content2">
  <div class="head">
    <div class="h1">Tell us about your business</div>
    <div class="p">You can write your own or let AI draft and then edit.</div>
  </div>
  <div class="scroll" style="position:relative">
    <div class="ai-overlay" id="aiOverlay">Generating your copy‚Ä¶</div>

    <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-self:flex-start">
      <button data-regen class="btn">Regenerate with Segwik AI</button>
    </div>

    <div class="card">
      <div class="label">Does this describe your mission accurately?</div>
      <textarea id="coMission" placeholder="State your mission‚Ä¶"></textarea>
    </div>
  </div>
</section>

<!-- Screen 3: Values -->
<section class="slide" data-step="content3">
  <div class="head">
    <div class="h1">Tell us about your business</div>
    <div class="p">You can write your own or let AI draft and then edit.</div>
  </div>
  <div class="scroll" style="position:relative">
    <div class="ai-overlay" id="aiOverlay">Generating your copy‚Ä¶</div>

    <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-self:flex-start">
      <button data-regen class="btn">Regenerate with Segwik AI</button>
    </div>

    <div class="card">
      <div class="label">Do you agree with this value statement?</div>
      <textarea id="coValues" placeholder="List a few core values‚Ä¶"></textarea>
    </div>
  </div>
</section>

<!-- Screen 4 (LAST of Phase 1): Differentiation -->
<section class="slide" data-step="content4">
  <div class="head">
    <div class="h1">Tell us about your business</div>
    <div class="p">You can write your own or let AI draft and then edit.</div>
  </div>
  <div class="scroll" style="position:relative">
    <div class="ai-overlay" id="aiOverlay">Generating your copy‚Ä¶</div>

    <div class="row" style="display:flex;gap:8px;flex-wrap:wrap;align-self:flex-start">
      <button data-regen class="btn">Regenerate with Segwik AI</button>
    </div>

    <div class="card">
      <div class="label">Is this a good way to differentiate your business?</div>
      <textarea id="coDiff" placeholder="What makes you different‚Ä¶"></textarea>
    </div>
  </div>
</section>

<!-- PHASE 1 ‚Üí PHASE 2 BRIDGE (no back/next/pager) -->
<section class="slide" data-step="bridge">
  <div class="head">
    <div class="h1">Congratulations! Your profile and company details are all set.</div>
  </div>
  <div class="scroll">
    <div class="card">
      <img
        src="https://d34hmiuaex7c0.cloudfront.net/2952/uploads/cmaspages/gallery/galleryitem_1760737883979.png"
        alt="Segwik setup complete"
        class="bridge-image"
      />
     
    </div>


 <div class="h1" style="margin-top:6px">Lets start building your first customer journey</div>
    <div class="p">Set up the steps that will guide your prospects automatically from the moment they connect with you.</div>

 
    <!-- Buttons moved OUTSIDE the card -->
    <div class="row" style="margin-top:12px;display:flex;gap:8px;align-items:center">
      <button id="bridgeSkip" class="btn">Skip</button>
      <button id="bridgeContinue" class="btn blue" style="margin-left:auto">Continue</button>
    </div>
  </div>
</section>





       



        


<!-- Step: Decide Entry -->
<section class="slide" data-step="entry">
  <div class="head">
    <div class="h1">What's your customer journey entry point?</div>
    <div class="p">Select from common starting points to see how contacts enter your journey.</div>
  </div>
  <div class="scroll">
    <div class="card">
      <div class="chips stacked" id="entryChips"></div>
      <div style="margin-top:8px">
        <a id="entryCustomLink" class="add-template" role="button">+ Create Custom Entry Point üîí</a>
      </div>
      <div class="right" style="margin-top:12px">
      </div>
    </div>
  </div>
</section>

<!-- Step: Entry Confirm -->
<section class="slide" data-step="entryConfirm">
  <div class="head">
    <div class="h1">Here‚Äôs how your customer journey begins</div>
    <div class="p">When someone downloads your digital card and completes the vCard form, it kicks off your follow-up journey‚Äîno manual work needed.</div>
  </div>
  <div class="scroll">
    <button id="viewDownloadForm" class="btn">Preview This Customer Journey Entry Point</button>

<!-- GIF preview of the entry flow -->
<img
  src="https://d34hmiuaex7c0.cloudfront.net/2952/uploads/cmaspages/gallery/galleryitem_1760747575341.gif"
  alt="Journey Entry Flow GIF"
  class="entry-gif"
/>

<!-- Right-aligned blue button to open the vCard peek sheet -->
<div class="row" style="margin-top:12px;display:flex;gap:8px;align-items:center">
  <button id="previewVCardBtn" class="btn blue" style="margin-left:auto">Preview My VCard</button>
</div>

  </div>
</section>

<!-- Step: Upload Images (moved here) -->
<!-- Step: Upload Images + Social Links -->
<section class="slide" data-step="images">
  <div class="head">
    <div class="h1">Add Your Images & Social Links</div>
    <div class="p">Upload your headshot and background image, then add your social profiles to complete your public profile.</div>
  </div>
  <div class="scroll">
    <div class="card">
      <div class="label">Upload Images</div>
      <div class="uploader">
        <label class="drop" id="photoDrop">
          <span class="ico"><svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></span>
          <span class="txt"><b>Upload Headshot</b>PNG or JPG, square works best</span>
          <input id="photo" type="file" accept="image/*">
          <span class="thumb" id="photoThumb" aria-hidden="true" style="display:none"></span>
        </label>
        <label class="drop" id="bannerDrop">
          <span class="ico"><svg width="20" height="20" viewBox="0 0 24 24"><path d="M12 5v14M5 12h14"/></svg></span>
          <span class="txt"><b>Upload Background</b>Wide cover image looks great</span>
          <input id="banner" type="file" accept="image/*">
          <span class="thumb" id="bannerThumb" aria-hidden="true" style="display:none"></span>
        </label>
      </div>
    </div>

    <!-- Moved Social Links card -->
    <div class="card">
      <div class="label">Social Links</div>
      <div id="socialList"></div>
      <button id="addSocial" class="btn social-add">+ Add social link</button>
      <div class="p" style="margin-top:6px">Choose one or more platforms, then paste the URL.</div>
    </div>

    <div class="row" style="margin-top:12px;display:flex;gap:8px;align-items:center">
  <button id="previewVCardBtn2" class="btn blue" style="margin-left:auto">Preview My VCard</button>
</div>
<div class="right" style="margin-top:12px">

    </div>
  </div>
</section>







        <!-- Step: Journey ‚Äî Choose actions -->
        <section class="slide" data-step="actions">
          <div class="head">
            <div class="h1">What should happen after the customer journey starts?</div>
            <div class="p">Select an action you want Segwik to do after the journey starts.</div>
          </div>
          <div class="scroll">
            <div class="card">
<div class="chips stacked" id="actionChips"></div>

              <div class="right" style="margin-top:12px">
              </div>
            </div>
          </div>
        </section>

        <!-- Step: Email Template Picker -->
<section class="slide" data-step="template">
  <div class="head">
    <div class="h1">Choose an Email Template</div>
    <div class="p">Select a pre-designed email template for your autoresponder.</div>
  </div>
  <div class="scroll">
    <div class="card">
      <div class="label">Recommended Templates</div>
      <div id="templateList" class="templates"></div>

<!-- Shown only when template == "Book a Meeting" -->
<div id="ctaDestinationRow" class="group" style="display:none; margin-top:10px">
  <h3>Destination</h3>
  <div class="help">Paste your scheduling link.</div>
  <input id="ctaDest" type="url" placeholder="https://">
</div>

      <div class="add-template" id="addTemplateLocked">+ Add Email Template üîí</div>
    </div>
  </div>
</section>





        
<!-- Step: Final Check (full-screen email preview + add follow-ups) -->
<section class="slide" data-step="finalcheck">
  <div class="head">
    <div class="h1">Final Check Before Activation</div>
    <div class="p">Take a moment to preview everything and make sure it looks just right.</div>
  </div>
  <div class="scroll">
    <div class="card">
  <div class="label-row">
    <div class="label">Timing: Immediately</div>
    <button id="sendTestBtn">Send me a Test Email</button>
  </div><br>

  <!-- Push confirmation (shown after clicking Send me a Test Email) -->
  <div id="testPush" class="push">Test email sent to your address.</div>

  <!-- Phone-styled preview (IDENTICAL look to the üëÅ modal) -->
  <div class="phone-frame final">
    <div class="phone-titlebar final">
      <div class="dot-r"></div><div class="dot-o"></div><div class="dot-g"></div>
      <div id="fullPhoneTitle" style="margin-left:8px;font-weight:800;color:#0F2D56">It‚Äôs great to be connected!</div>
    </div>
    <div class="email-preview final">
      <div class="mail-frame" id="mailPreviewFull"></div>
    </div>
  </div>

  <!-- Add more follow-ups link (opens upgrade modal) -->
  <div style="margin-top:10px">
    <a id="addMoreFollowups" class="add-template" role="button">+ Add more follow-ups</a>
  </div>
</div>

  </div>
</section>

      
 



        <!-- Step: Summary with toggle -->
        <section class="slide" data-step="summary">
  <div class="head">
    <div class="h1">Your vCard Download Journey is ready</div>
    <div class="p">Share your card link or QR, and we‚Äôll handle the follow-up.</div>
  </div>
  <div class="scroll">
    <!-- Box 1 -->
    <div class="card">
      <ul style="margin:0;padding-left:18px;line-height:1.8">
        <li><span id="sumCard" class="ok">Digital card complete</span></li>
        <li><span class="ok">Instant autoresponder configured</span></li>
        <li><span id="sumCtas" class="ok">CTA added</span></li>
      </ul>
    </div>

    <!-- Box 2 -->
    <div class="card" style="text-align:center">
      <img
        src="https://d34hmiuaex7c0.cloudfront.net/2952/uploads/cmaspages/gallery/galleryitem_1760737883979.png"
        alt="Segwik setup complete"
        class="bridge-image"
        style="max-width:100%;border-radius:12px"
      />
    </div>

    <!-- Box 3 -->
    <div class="card">
      <div class="row" style="align-items:center;gap:12px;justify-content:space-between">
        <div style="font-weight:800">Activate Journey</div>
        <div id="toggle" class="switch" role="switch" aria-checked="false"><span class="knob"></span></div>
      </div>
    </div>
  </div>
</section>

      </div>

      <!-- Back/Next + pager (Phase 1) -->
<div id="nav1" class="nav">
  <button id="backBtn1" class="btn small ghost">Back</button>
  <button id="nextBtn1" class="btn small">Next</button>
</div>
<div id="pager1" class="pager"></div>

<!-- Back/Next + pager (Phase 2) -->
<div id="nav2" class="nav" style="display:none">
  <button id="backBtn2" class="btn small ghost">Back</button>
  <button id="nextBtn2" class="btn small">Next</button>
</div>
<div id="pager2" class="pager" style="display:none"></div>


      <!-- Upgrade modal -->
      <div id="upgradeModal" class="modal-wrap" role="dialog" aria-modal="true" aria-labelledby="upgTitle">
        <div class="modal">
          <h3 id="upgTitle">Unlock more automations</h3>
          <p>Upgrade to <strong>Segwik Grow</strong> to enable additional CTAs and more automations.</p>
          <div class="row">
            <button class="btn ghost" id="upgClose">Not now</button>
            <button class="btn blue" id="upgGo">See plans</button>
          </div>
        </div>
      </div>

      <!-- vCard peek sheet (steps 1‚Äì2) -->
      <div id="peekProfileSheet" class="peeksheet-wrap" aria-hidden="true" onclick="if(event.target.id==='peekProfileSheet'){togglePeek(false)}">
        <div class="peeksheet" role="dialog" aria-modal="true" aria-label="vCard field preview" onclick="event.stopPropagation()">
          <div class="peeksheet-top">
            <div class="peeksheet-title">Where this info appears on your vCard</div>
            <button id="peekProfileClose" class="peeksheet-close" aria-label="Close">√ó</button>
          </div>
          <div class="peeksheet-body">
            <div class="vcard-demo">
              <div class="v-demo-banner" id="peekDemoBanner"></div>
              <div class="v-demo-headrow">
                <div class="v-demo-photo" id="peekDemoPhoto">
                  <svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>
                </div>
                <button class="v-demo-save">Save Contact</button>
              </div>
              <div class="v-demo-id">
                <div class="v-demo-name" id="peekName">Your Name</div>
                <div class="v-demo-company" id="peekCompany">Your Company</div>
                <div class="v-demo-title" id="peekTitle">Your Title</div>
                <div class="v-demo-headline" id="peekHeadline">Your Headline</div>
              </div>
              <div class="v-demo-list" id="peekList"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Phone-styled email preview -->
      <div id="phonePreview" class="phone-modal" aria-hidden="true" onclick="if(event.target.id==='phonePreview'){togglePhone(false)}">
        <div class="phone-frame" onclick="event.stopPropagation()">
          <div class="phone-titlebar">
            <div class="dot-r"></div><div class="dot-o"></div><div class="dot-g"></div>
            <div id="phoneTitle" style="margin-left:8px;font-weight:800;color:#0F2D56">It‚Äôs great to be connected!</div>
            <button id="phoneClose" class="btn small ghost" style="margin-left:auto">Close</button>
          </div>
          <div class="email-preview">
            <div class="mail-frame" id="mailPreview"></div>
          </div>
        </div>
      </div>
    </div>

<!-- Form Preview sheet -->
<div id="formPreviewSheet" class="peeksheet-wrap" aria-hidden="true" onclick="if(event.target.id==='formPreviewSheet'){toggleFormPreview(false)}">
  <div class="peeksheet" role="dialog" aria-modal="true" aria-label="Form preview" onclick="event.stopPropagation()">
    <div class="peeksheet-top">
      <div class="peeksheet-title">Download My Digital Card ‚Äî Contact Form</div>
      <button id="formPreviewClose" class="peeksheet-close" aria-label="Close">√ó</button>
    </div>
    <div class="peeksheet-body">
      <div class="form-preview">
        <div class="big-title">
          <span class="ok">‚úî</span> Please Share Your Information
        </div>
        <div class="sub">To help stay in touch, please share your information back.</div>

        <div class="row">
          <div class="label">Your First Name*</div>
          <input type="text" placeholder="">
          <div class="label">Your Last Name*</div>
          <input type="text" placeholder="">
          <div class="label">Your Email*</div>
          <input type="email" placeholder="">
          <div class="label">Your Phone*</div>
          <div class="intl-phone">
            <select>
              <option>+1</option>
              <option>+44</option>
              <option>+61</option>
            </select>
            <input type="text" placeholder="Enter phone number">
          </div>
          <div class="label">Your Company</div>
          <input type="text" placeholder="">
          <div><a>Add Note...</a></div>
          <textarea placeholder="Enter note..."></textarea>
          <div class="hint">* Required fields</div>
          <button class="submit" disabled>Submit And Save Contact</button>
        </div>
      </div>
    </div>
  </div>
</div>

    <!-- Bottom icon tray -->
    <div class="tray" id="footer-tray">
      <div class="ibtn" data-icon="home"></div>
      <div class="ibtn" data-icon="card"></div>
      <div class="ibtn" data-icon="flow"></div>
      <div class="ibtn" data-icon="mail"></div>
      <div class="ibtn" data-icon="user"></div>
    </div>
  </div>

<script>
  
/* ========= Carousel / Pager ========= */
const carousel = document.getElementById('carousel');
const slides = Array.from(carousel.querySelectorAll('.slide'));
let idx = 0;
let doAutoGenNext = false;
let chosenPersona = 'professional';
let dummyIdx = 0;


function goTo(i){
    idx = Math.max(0, Math.min(slides.length-1, i));
  carousel.style.transform = `translateX(-${idx*100}%)`;
    // ALWAYS refresh Step 5 preview when landing there
  if (i === IDX.finalcheck) {
    syncPhoneTitle();
    renderMail();
  }
  // One-time regen button attention (per screen)
  const currentStep = slides[idx]?.dataset?.step || null;
  maybeAutoAnimateRegenOnEnter(currentStep);


  renderDots(); updateNav();
  // Phase-specific nav/pagers
  const nav1   = document.getElementById('nav1');
  const pager1 = document.getElementById('pager1');
  const nav2   = document.getElementById('nav2');
  const pager2 = document.getElementById('pager2');

  // Hide all by default
  nav1.style.display = 'none';
  pager1.style.display = 'none';
  nav2.style.display = 'none';
  pager2.style.display = 'none';

const inP1 = idx <= IDX.contentLast;        // Phase 1 = welcome .. last content screen
const inP2 = idx >= IDX.entry;        // Phase 2 = entry .. end


  if (inP1) {
    // Hide on very first welcome screen, show otherwise
    if (idx !== 0) {
      nav1.style.display = '';
      pager1.style.display = '';
    }
  } else if (inP2) {
    nav2.style.display = '';
    pager2.style.display = '';
  }



  if (idx === IDX.preview) { renderStatus(); renderInlineVcardFromInputs(); }
 if (idx >= IDX.content1 && idx <= IDX.contentLast) {
  // Seed persona automatically based on current selections, then auto-generate once.
  if (!doAutoGenNext) {
    chosenPersona = inferChosenPersona();
    dummyIdx = 0;
    doAutoGenNext = true;
  }
  setTimeout(()=>{ withLoader(fillFromDummy); doAutoGenNext = false; }, 50);
}


}

function stepIndex(name){
  return slides.findIndex(s => s.dataset && s.dataset.step === name);
}
const IDX = {
  preview:       stepIndex('preview'),
personality:   stepIndex('bp-all'), // single-screen brand personality
  actions:       stepIndex('actions'),
  template:      stepIndex('template'),

  // NEW: first/last content screens
  content1:      stepIndex('content1'),
  contentLast:   stepIndex('content4'),

  // PHASE 1 ‚Üí PHASE 2 bridge screen
  bridge:        stepIndex('bridge'),


  logo:          stepIndex('logo'),
  handoff:       stepIndex('handoff'),
  entry:         stepIndex('entry'),
  images:        stepIndex('images'),
  entryConfirm:  stepIndex('entryConfirm'),
  finalcheck:    stepIndex('finalcheck'),
  summary:       stepIndex('summary')
};

/* ===== One-time "Regenerate with Segwik AI" animation control ===== */
const regenAnimState = {}; // step -> { autoShown: true, clickShown: true }

function stepNameForElement(el){
  const slide = el.closest('.slide');
  return slide?.dataset?.step || null;
}

function animateRegenButtonsOnce(step, reason /* 'auto' | 'click' */){
  if(!step) return;
  regenAnimState[step] = regenAnimState[step] || {};
  const key = reason === 'click' ? 'clickShown' : 'autoShown';
  if (regenAnimState[step][key]) return;

  const slide = slides.find(s => s.dataset && s.dataset.step === step);
  if(!slide) return;

  slide.querySelectorAll('[data-regen]').forEach(b=>{
    b.classList.add('regen-animate');
    b.addEventListener('animationend', ()=> b.classList.remove('regen-animate'), { once:true });
  });

  regenAnimState[step][key] = true;
}

function maybeAutoAnimateRegenOnEnter(step){
  // Show ONCE on first visit ONLY for the first content screen ("overview").
  // No auto animation for mission/values/diff screens.
  if(step === 'content1'){
    animateRegenButtonsOnce(step, 'auto');
  }
}



function renderDots(){
  const pager1 = document.getElementById('pager1');
  const pager2 = document.getElementById('pager2');
  if (!pager1 || !pager2) return;

  // Clear both
  pager1.innerHTML = '';
  pager2.innerHTML = '';

  const inP1 = idx <= IDX.contentLast;
  const inP2 = idx >= IDX.entry
;

  if (inP1) {
    // Phase 1 dots: indices 0 .. IDX.contentLast
    for (let i = 0; i <= IDX.contentLast; i++){
      const d = document.createElement('div');
      d.classList.add('dot');
      // Mark the final content screen as "finish" dot
      if (slides[i].dataset && slides[i].dataset.step === 'content4') d.classList.add('finish');
      if (i === idx) d.classList.add('active');
      d.onclick = () => goTo(i);
      pager1.appendChild(d);
    }
    } else if (inP2) {
    // Phase 2 dots: indices IDX.entry .. slides.length-1
    for (let i = IDX.entry; i < slides.length; i++) {
      const d = document.createElement('div');
      d.classList.add('dot');
      if (i === idx) d.classList.add('active');
      d.onclick = () => goTo(i);
      pager2.appendChild(d);
    }
  }

}

function updateNav(){
  const inP1 = idx <= IDX.contentLast;
  const inP2 = idx >= IDX.entry;

  // Pick the active phase's buttons
  const back = document.getElementById(inP1 ? 'backBtn1' : 'backBtn2');
  const next = document.getElementById(inP1 ? 'nextBtn1' : 'nextBtn2');

  if (!back || !next) return;

  // Back button ghosted at the start of each phase
 const isPhaseStart = inP1 ? (idx === 0) : (idx === IDX.entry);
  back.classList.toggle('ghost', isPhaseStart);

  // Next text:
  // - Phase 1: "Finish" on last content screen, otherwise "Next"
  // - Phase 2: "Done" on very last slide, otherwise "Next"
  if (inP1) {
    next.textContent = (idx === IDX.contentLast) ? 'Finish' : 'Next';
  } else {
    next.textContent = (idx === slides.length - 1) ? 'Done' : 'Next';
  }
}


// Phase 1 buttons
document.getElementById('backBtn1')?.addEventListener('click', ()=> goTo(idx-1));
document.getElementById('nextBtn1')?.addEventListener('click', ()=>{
  if (idx === IDX.contentLast) {
    // Finish Phase 1: go to the bridge screen first
    goTo(IDX.bridge);
  } else {
    goTo(idx+1);
  }
});





// Phase 2 buttons
document.getElementById('backBtn2')?.addEventListener('click', ()=> goTo(idx-1));
document.getElementById('nextBtn2')?.addEventListener('click', ()=> goTo(idx+1));

renderDots(); updateNav();

/* quick nav */
document.getElementById('startCard')?.addEventListener('click', ()=>{
  goTo(1);
document.getElementById('nav1').style.display = '';
document.getElementById('pager1').style.display = '';

});
document.getElementById('skip')?.addEventListener('click', ()=>{
  goTo(1);
  document.getElementById('nav1').style.display = '';
document.getElementById('pager1').style.display = '';

});
// Bridge screen actions ‚Üí go to Phase 2 intro
document.getElementById('bridgeSkip')?.addEventListener('click', ()=> goTo(IDX.entry));
document.getElementById('bridgeContinue')?.addEventListener('click', ()=> goTo(IDX.entry));




/* ========= Global inputs/state ========= */
const S = {
  firstName: document.getElementById('firstName'),
  lastName : document.getElementById('lastName'),
  title    : document.getElementById('title'),
  company  : document.getElementById('company'),
  headline : document.getElementById('headline'),
  photo    : document.getElementById('photo'),
  banner   : document.getElementById('banner'),
  phoneBiz : document.getElementById('phoneBiz'),
  phonePersonal: document.getElementById('phonePersonal'),
  emailBiz : document.getElementById('emailBiz'),
  emailPersonal: document.getElementById('emailPersonal'),
  website  : document.getElementById('website'),
    ctaDest  : document.getElementById('ctaDest'),

  subject  : document.getElementById('subjectLine'),
  logo     : document.getElementById('logo'),
    industry : document.getElementById('industry'),
  subIndustry : document.getElementById('subIndustry'),

};
Object.values(S).forEach(el=>{ if(el) el.addEventListener('input', ()=>updatePreviews()); });

/* ========= Social builder ========= */
const socialOptions = [
  {key:'linkedin_personal', label:'LinkedIn (Personal)'},
  {key:'linkedin_business', label:'LinkedIn (Business)'},
  {key:'facebook', label:'Facebook'},
  {key:'instagram', label:'Instagram'},
  {key:'pinterest', label:'Pinterest'},
  {key:'x', label:'X (Twitter)'},
  {key:'google', label:'Google'},
  {key:'youtube', label:'YouTube'},
  {key:'tiktok', label:'TikTok'}
];
const socials = [];
const socialList = document.getElementById('socialList');
document.getElementById('addSocial')?.addEventListener('click', ()=>{
  socials.push({platform:'linkedin_business', url:''});
  renderSocialRows(); updatePreviews();
});
function renderSocialRows(){
  socialList.innerHTML = '';
  socials.forEach((row, idx)=>{
    const wrap = document.createElement('div');
    wrap.className = 'social-row';
    wrap.innerHTML = `
      <select aria-label="Social platform">
        ${socialOptions.map(opt=>`<option value="${opt.key}" ${opt.key===row.platform?'selected':''}>${opt.label}</option>`).join('')}
      </select>
      <input type="url" placeholder="https://..." value="${row.url || ''}">
      <button class="remove" title="Remove"><svg width="16" height="16" viewBox="0 0 24 24"><path d="M18 6L6 18M6 6l12 12"/></svg></button>
    `;
    const sel = wrap.querySelector('select');
    const input = wrap.querySelector('input');
    const btn = wrap.querySelector('button.remove');
    sel.addEventListener('change', (e)=>{ socials[idx].platform = e.target.value; updatePreviews(); });
    input.addEventListener('input', (e)=>{ socials[idx].url = e.target.value.trim(); updatePreviews(); });
    btn.addEventListener('click', ()=>{ socials.splice(idx,1); renderSocialRows(); updatePreviews(); });
    socialList.appendChild(wrap);
  });
}

/* ========= Image uploads ‚Üí data URLs ========= */
let photoUrl='', bannerUrl='', logoUrl='';
const photoThumb = document.getElementById('photoThumb');
const bannerThumb = document.getElementById('bannerThumb');
const logoThumb  = document.getElementById('logoThumb');
function readToDataURL(file, cb){ const r=new FileReader(); r.onload = e => cb(e.target.result); r.readAsDataURL(file); }
S.photo?.addEventListener('change', ()=>{
  const f=S.photo.files?.[0]; if(!f) return;
  readToDataURL(f, url=>{ photoUrl = url; if(photoThumb){ photoThumb.style.display='block'; photoThumb.style.backgroundImage = `url('${url}')`; } updatePreviews(); });
});
S.banner?.addEventListener('change', ()=>{
  const f=S.banner.files?.[0]; if(!f) return;
  readToDataURL(f, url=>{ bannerUrl = url; if(bannerThumb){ bannerThumb.style.display='block'; bannerThumb.style.backgroundImage = `url('${url}')`; } updatePreviews(); });
});
S.logo?.addEventListener('change', ()=>{
  const f=S.logo.files?.[0]; if(!f) return;
  readToDataURL(f, url=>{ logoUrl = url; if(logoThumb){ logoThumb.style.display='block'; logoThumb.style.backgroundImage = `url('${url}')`; } if(phoneModalOpen) renderMail(); });
});

/* ========= Icons & helpers ========= */
function i16(name){
  switch (name) {


case 'phone': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M22 16.9v3a2 2 0 0 1-2.2 2A19.8 19.8 0 0 1 3.1 5.3 2 2 0 0 1 5 3h3a2 2 0 0 1 2 1.7c.1.8.3 1.6.6 2.4a2 2 0 0 1-.5 2L8.1 9.9a16 16 0 0 0 6 6l1.5-1.1a2 2 0 0 1 2.1-.5c.8.3 1.6.5 2.4.6A2 2 0 0 1 22 16.9z"/>
  </svg>`;

case 'mail': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <rect x="3" y="5" width="18" height="14" rx="2"/>
    <path d="M3 7l9 6 9-6"/>
  </svg>`;

case 'link': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <!-- left chain -->
    <path d="M8.5 14.5l-1 1a4.5 4.5 0 1 1-6.4-6.4l1-1a4.5 4.5 0 0 1 6.4 0"/>
    <!-- right chain -->
    <path d="M15.5 9.5l1-1a4.5 4.5 0 1 1 6.4 6.4l-1 1a4.5 4.5 0 0 1-6.4 0"/>
    <!-- connector -->
    <path d="M9 12h6"/>
  </svg>`;

case 'linkedin': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M4 9h4v11H4z"/>
    <circle cx="6" cy="5" r="2"/>
    <path d="M10 9h4v2a4 4 0 0 1 8 0v9h-4v-8a2 2 0 0 0-4 0v8h-4z"/>
  </svg>`;

case 'youtube': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <!-- body -->
    <path d="M22 12s0-3-.4-4.5A3 3 0 0 0 19.5 5C17.3 4.8 12 4.8 12 4.8s-5.3 0-7.5.2A3 3 0 0 0 2.4 7.5C2 9 2 12 2 12s0 3 .4 4.5A3 3 0 0 0 4.5 19c2.2.2 7.5.2 7.5.2s5.3 0 7.5-.2a3 3 0 0 0 2.1-2.5C22 15 22 12 22 12z"/>
    <!-- centered play triangle as stroke geometry -->
    <path d="M10 9l5 3-5 3z"/>
  </svg>`;

case 'x': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M4 4l16 16M20 4L4 20"/>
  </svg>`;

case 'instagram': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <rect x="3" y="3" width="18" height="18" rx="5"/>
    <circle cx="12" cy="12" r="4"/>
    <circle cx="17" cy="7" r="1"/>
  </svg>`;

case 'facebook': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M18 2h-3a4 4 0 0 0-4 4v3H8v4h3v9h4v-9h3l1-4h-4V6a1 1 0 0 1 1-1h3z"/>
  </svg>`;

case 'pinterest': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <circle cx="12" cy="12" r="10"/>
    <path d="M11 19c.5-3.8 1.8-6 1.8-8 0-1.6-1.2-2.7-2.8-2.7S7.2 9.2 7.2 10.8c0 1.1.6 2.1 1.8 2.5"/>
  </svg>`;

case 'google': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <!-- cleaner G: outer circle arc + crossbar -->
    <path d="M20 12a8 8 0 1 1-2.34-5.66"/>
    <path d="M12 12h8"/>
  </svg>`;

case 'tiktok': return `
  <svg width="16" height="16" viewBox="0 0 24 24">
    <path d="M14 6a5 5 0 0 0 5 5"/>
    <path d="M10 7v8.5a3.5 3.5 0 1 1-3-3.45"/>
  </svg>`;



}

}
function socialIconKey(platform){
  if(platform && platform.startsWith('linkedin')) return 'linkedin';
  return { facebook:'facebook', instagram:'instagram', pinterest:'pinterest', x:'x', google:'google', youtube:'youtube', tiktok:'tiktok' }[platform] || 'link';
}
function safe(v,fallback=''){ return (v||'').trim()||fallback; }
function oxfordList(arr){
  if(arr.length<=1) return arr.join('');
  if(arr.length===2) return `${arr[0]} and ${arr[1]}`;
  return `${arr.slice(0,-1).join(', ')}, and ${arr[arr.length-1]}`;
}

/* ========= Inline vCard (Step 3) & Status ========= */
function inlineRow(iconName, text){
  if(!text) return '';
  return `<div class="v-demo-row"><span class="icon-pill" aria-hidden="true">${i16(iconName)}</span><span>${text}</span></div>`;
}
function renderInlineVcardFromInputs(){
  const host = document.getElementById('vcardInline');
  if(!host) return;
  const name = `${safe(S.firstName.value,'Your')} ${safe(S.lastName.value,'Name')}`.trim();
  const company = safe(S.company.value,'Your Company');
  const title = safe(S.title.value,'Your Title');
  const headline = safe(S.headline.value,'Your Headline');
  const phoneA = safe(S.phoneBiz.value,'');
  const phoneB = safe(S.phonePersonal.value,'');
  const emailA = safe(S.emailBiz.value,'');
  const emailB = safe(S.emailPersonal.value,'');
  const website = safe(S.website.value,'');
  const socialRows = socials.filter(s=>s.url).map(s => inlineRow(socialIconKey(s.platform), s.url)).join('');
  host.innerHTML = `
    <div class="v-demo-banner" id="inlineBanner" style="${bannerUrl?`background-image:url('${bannerUrl}')`:''}"></div>
    <div class="v-demo-headrow">
      <div class="v-demo-photo" id="inlinePhoto" style="${photoUrl?`background-image:url('${photoUrl}')`:''}">
        ${photoUrl?'':'<svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>'}
      </div>
      <button class="v-demo-save">Save Contact</button>
    </div>
    <div class="v-demo-id">
      <div class="v-demo-name" id="inlineName">${name||'Your Name'}</div>
      <div class="v-demo-company" id="inlineCompany">${company}</div>
      <div class="v-demo-title" id="inlineTitle">${title}</div>
      <div class="v-demo-headline" id="inlineHeadline">${headline}</div>
    </div>
    <div class="v-demo-list" id="inlineList">
      ${inlineRow('phone', phoneA)}
      ${inlineRow('phone', phoneB)}
      ${inlineRow('mail',  emailA)}
      ${inlineRow('mail',  emailB)}
      ${inlineRow('link',  website)}
      ${socialRows}
    </div>
  `;
}
function renderStatus(){
  const socialValid = socials.filter(s=>s.url);
  const missing = [];
  if(!(S.firstName.value && S.lastName.value)) missing.push('first & last name');
  if(!(S.phoneBiz.value || S.phonePersonal.value)) missing.push('at least one phone');
  if(!(S.emailBiz.value || S.emailPersonal.value)) missing.push('at least one email');
  if(!photoUrl) missing.push('headshot');
  if(!bannerUrl) missing.push('background image');
  if(!S.title.value) missing.push('title/role');
  if(!S.headline.value) missing.push('headline');
  if(!(S.website.value || socialValid.length>0)) missing.push('website or at least one social link');

  const complete = missing.length===0;

  const missingList = missing.length
    ? `<ul style="margin:6px 0; padding-left:20px;">${missing.map(item => `<li>${item}</li>`).join('')}</ul>`
    : '';

  const status = complete
    ? `‚úÖ <span class="ok">Your digital card is complete</span>`
    : `‚ö†Ô∏è <span class="warn">Your public profile isn‚Äôt ready yet. Please add:</span><br>${missingList}Completing your profile helps your vcard look complete and professional.`;

  const statusEl = document.getElementById('cardStatus');
  if(statusEl) statusEl.innerHTML = status;

  const fillBtn = document.getElementById('btnFillInfo');
  if(fillBtn) fillBtn.style.display = complete ? 'none' : 'inline-flex';

  const sum = document.getElementById('sumCard');
  if(sum) sum.textContent = complete ? 'Digital card complete' : 'Digital card incomplete';
}


/* Keep everything live */
function updatePreviews(){
  if (idx === IDX.preview) { renderStatus(); renderInlineVcardFromInputs(); }

  if(sheet.classList.contains('show')) fillPeekFromInputs();

  // ALWAYS update the email previews (phone modal + Step 5 full preview)
  renderMail();
}


/* ========= Peek sheet ========= */
const sheet = document.getElementById('peekProfileSheet');
const btnClose = document.getElementById('peekProfileClose');
function togglePeek(show){
  sheet.classList.toggle('show', !!show);
  sheet.setAttribute('aria-hidden', show ? 'false' : 'true');
  if(show) fillPeekFromInputs();
}
btnClose?.addEventListener('click', ()=>togglePeek(false));
window.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && sheet.classList.contains('show')) togglePeek(false); });
document.querySelectorAll('[data-peek]').forEach(b=> b.addEventListener('click', ()=>togglePeek(true)));

function peekRow(iconName, text){
  if(!text) return '';
  return `<div class="v-demo-row"><span class="icon-pill" aria-hidden="true">${i16(iconName)}</span><span>${text}</span></div>`;
}
function fillPeekFromInputs(){
  const name = `${safe(S.firstName.value,'Your')} ${safe(S.lastName.value,'Name')}`.trim();
  document.getElementById('peekName').textContent     = name || 'Your Name';
  document.getElementById('peekCompany').textContent  = safe(S.company.value,'Your Company');
  document.getElementById('peekTitle').textContent    = safe(S.title.value,'Your Title');
  document.getElementById('peekHeadline').textContent = safe(S.headline.value,'Your Headline');

  const bannerDiv = document.getElementById('peekDemoBanner');
  const photoDiv  = document.getElementById('peekDemoPhoto');
  bannerDiv.style.backgroundImage = bannerUrl ? `url('${bannerUrl}')` : '';
  if (photoUrl){ photoDiv.style.backgroundImage = `url('${photoUrl}')`; photoDiv.innerHTML=''; }
  else { photoDiv.style.backgroundImage=''; if(!photoDiv.querySelector('svg')) photoDiv.innerHTML='<svg viewBox="0 0 24 24"><circle cx="12" cy="8" r="4"/><path d="M4 20a8 8 0 0 1 16 0"/></svg>'; }

  const phoneA = safe(S.phoneBiz.value,''), phoneB = safe(S.phonePersonal.value,'');
  const emailA = safe(S.emailBiz.value,''), emailB = safe(S.emailPersonal.value,'');
  const website = safe(S.website.value,'');
  const socialRows = socials.filter(s=>s.url).map(s => peekRow(socialIconKey(s.platform), s.url)).join('');
  document.getElementById('peekList').innerHTML = `
    ${peekRow('phone', phoneA)}
    ${peekRow('phone', phoneB)}
    ${peekRow('mail',  emailA)}
    ${peekRow('mail',  emailB)}
    ${peekRow('link',  website)}
    ${socialRows}
  `;
}

/* ========= Actions & upgrade modal ========= */
const actionDefs = [
  {key:'email', label:'Send the Contact an Email', locked:false},
  {key:'text', label:'Send the Contact a Text Message', locked:true},
  {key:'journey', label:'Send Push Notification', locked:true},
  {key:'task', label:'Assign a Task to Me', locked:true},
  {key:'journey', label:'Add to a Journey', locked:true},
  {key:'journey', label:'Update Attribute(s)', locked:true},
  {key:'journey', label:'Generate a Transaction', locked:true},
  {key:'journey', label:'Assign a Workflow', locked:true},
];
const chosenActions = new Set(['email']);
const chipsHost = document.getElementById('actionChips');
const upg = document.getElementById('upgradeModal');
document.getElementById('upgClose')?.addEventListener('click', ()=>upg.classList.remove('show'));
document.getElementById('upgGo')?.addEventListener('click', ()=>{ upg.classList.remove('show'); alert('Navigate to pricing'); });

actionDefs.forEach(a=>{
  const chip = document.createElement('button');
  chip.className='chip'+(chosenActions.has(a.key)?' active':'');
  chip.textContent = a.label + (a.locked?' üîí':'');
  chip.onclick = ()=>{
    if(a.locked){ upg.classList.add('show'); return; }
    if(chosenActions.has(a.key)) chosenActions.delete(a.key); else chosenActions.add(a.key);
    chip.classList.toggle('active');
  };
  chipsHost.appendChild(chip);
});


/* ========= Email Template Picker ========= */
const templateDefs = [
  {key:'book',  name:'vCard Downloaded ‚Äì Book a Call'},
  {key:'email', name:'vCard Downloaded ‚Äì Send an Email'},
  {key:'call',  name:'vCard Downloaded ‚Äì Call Me'}
];


let chosenTemplate = 'email';

function renderTemplateList(){
  const host = document.getElementById('templateList');
  if(!host) return;
  host.innerHTML = '';
  templateDefs.forEach(t=>{
    const row = document.createElement('div');
    row.className = 'template-row' + (chosenTemplate===t.key ? ' active' : '');
    row.innerHTML = `
      <div class="name">${t.name}</div>
      <div class="actions">
        <button class="eye" title="Preview" aria-label="Preview ${t.name}">
          <svg width="18" height="18" viewBox="0 0 24 24">
            <path d="M1 12s4-7 11-7 11 7 11 7-4 7-11 7S1 12 1 12z"/>
            <circle cx="12" cy="12" r="3"/>
          </svg>
        </button>
      </div>
    `;

    // Eye opens the phone-style preview modal (subject titlebar set to template name)
    row.querySelector('.eye').addEventListener('click', ()=>{
  document.getElementById('phoneTitle').textContent = t.name;
  // Open the phone preview and render using THIS row's template (without selecting it)
  togglePhone(true, t.key);
});


    // Clicking the row selects the template
    row.addEventListener('click', (e)=>{
      if(e.target.closest('.eye')) return; // ignore the eye button itself
      chosenTemplate = t.key;
      renderTemplateList();
      syncPhoneTitle();
      showCtaDestIfNeeded();
      renderMail();
    });

    host.appendChild(row);
  });

  // ensure Destination row visibility matches current selection
  showCtaDestIfNeeded();
}
renderTemplateList();

renderTemplateList();

// Locked ‚ÄúAdd Template‚Äù link
document.getElementById('addTemplateLocked')?.addEventListener('click', ()=>{
  const title = document.getElementById('upgTitle');
  if(title) title.textContent = 'Requires an Upgrade';
  upg.classList.add('show');
});

function showCtaDestIfNeeded(){
  const row = document.getElementById('ctaDestinationRow');
  if(!row) return;
  row.style.display = (chosenTemplate === 'book') ? '' : 'none';
}





/* ========= Brand Personality (ONE SCREEN ‚Äî MULTISELECT) ========= */
/* Data: Five-Dimension Brand Personality Sets */
const PERSONA_OPTS = {
  sincerity: [
    "Honest","Cheerful","Wholesome","Genuine","Family-oriented","Friendly","Caring"
  ],
  excitement: [
    "Daring","Trendy","Imaginative","Spirited","Exciting","Up-to-date","Youthful"
  ],
  competence: [
    "Reliable","Efficient","Successful","Expert","Intelligent","Responsible","Trustworthy"
  ],
  sophistication: [
    "Upper-class","Charming","Glamorous","Stylish","Refined","Luxurious","Elegant"
  ],
  ruggedness: [
    "Outdoorsy","Rugged","Masculine","Tough","Durable","Strong","Adventurous"
  ]
};

/* State: all multiselect */
const Persona = {
  sincerity: new Set(),
  excitement: new Set(),
  competence: new Set(),
  sophistication: new Set(),
  ruggedness: new Set()
};

/* Generic chip renderer (multi) */
function renderPersonaChips(hostId, setRef, opts){
  const host = document.getElementById(hostId);
  if(!host) return;
  host.innerHTML = '';
  opts.forEach(label=>{
    const b = document.createElement('button');
    b.className = 'chip' + (setRef.has(label)?' active':'');
    b.textContent = label;
    b.addEventListener('click', ()=>{
      if(setRef.has(label)) setRef.delete(label); else setRef.add(label);
      renderPersona(); // re-render this screen only
    });
    host.appendChild(b);
  });
}

/* Render ALL five groups */
function renderPersona(){
  renderPersonaChips('bpSincerity',     Persona.sincerity,     PERSONA_OPTS.sincerity);
  renderPersonaChips('bpExcitement',    Persona.excitement,    PERSONA_OPTS.excitement);
  renderPersonaChips('bpCompetence',    Persona.competence,    PERSONA_OPTS.competence);
  renderPersonaChips('bpSophistication',Persona.sophistication,PERSONA_OPTS.sophistication);
  renderPersonaChips('bpRuggedness',    Persona.ruggedness,    PERSONA_OPTS.ruggedness);
}

/* Initial render for the single-screen personality step */
renderPersona();



/* Map selections to existing AI persona buckets (for generator) */
function inferChosenPersona(){
  // Count selections per dimension
  const counts = {
    sincerity:     Persona.sincerity.size,
    excitement:    Persona.excitement.size,
    competence:    Persona.competence.size,
    sophistication:Persona.sophistication.size,
    ruggedness:    Persona.ruggedness.size
  };

  // Quick helpers to see if certain key traits were chosen
  const hasAny = (setRef, arr) => arr.some(t => setRef.has(t));

  // Priority heuristics ‚Üí map to existing DUMMY keys:
  //   'friendly','bold','innovative','reliable','professional','thoughtful'
  // 1) If Excitement or Ruggedness dominates ‚Üí bold
  if (counts.excitement >= Math.max(counts.sincerity, counts.competence, counts.sophistication) ||
      counts.ruggedness  >= Math.max(counts.sincerity, counts.competence, counts.sophistication)) {
    // If Excitement leans more on "Imaginative/Up-to-date" ‚Üí innovative
    if (hasAny(Persona.excitement, ["Imaginative","Up-to-date","Trendy","Exciting","Youthful"])) {
      return 'innovative';
    }
    return 'bold';
  }

  // 2) If Competence dominates ‚Üí reliable (professional-ish)
  if (counts.competence > counts.sincerity && counts.competence >= counts.sophistication) {
    return 'reliable';
  }

  // 3) If Sincerity dominates ‚Üí friendly / thoughtful
  if (counts.sincerity >= Math.max(counts.competence, counts.sophistication)) {
    if (hasAny(Persona.sincerity, ["Caring","Genuine","Honest","Friendly"])) return 'friendly';
    return 'thoughtful';
  }

  // 4) If Sophistication is strong ‚Üí professional (reliable tone)
  if (counts.sophistication > 0) {
    return 'professional';
  }

  // Default fallback
  return 'professional';
}








/* ========= AI Generate (dummy) ========= */
const overlay = document.getElementById('aiOverlay');
const coOverview = document.getElementById('coOverview');
const coMission  = document.getElementById('coMission');
const coValues   = document.getElementById('coValues');
const coDiff     = document.getElementById('coDiff');
const DUMMY = {
  professional: [
    {
      overview: "Segwik is a human-centered Relationship Operating System built to bring structure, clarity, and efficiency to how small teams manage connections. We help businesses unify their contacts, communication, and workflows into one seamless environment that drives consistent growth and meaningful relationships.",
      mission: "Our mission is to simplify the way professionals operate by removing unnecessary friction in daily tasks. We empower teams to focus their time and energy on serving clients, closing deals, and nurturing long-term relationships instead of juggling disconnected tools.",
      values: "We value clarity in communication, reliability in our systems, and empathy for the customer experience. Through continuous improvement, we make sure our platform evolves with the needs of modern professionals.",
      diff: "Unlike traditional CRMs that require complex setup and maintenance, Segwik offers an all-in-one, AI-assisted workspace designed for immediate usability. We streamline every touchpoint so teams can operate efficiently from day one."
    },
    {
      overview: "At Segwik, we help ambitious professionals and small teams gain full visibility into their pipelines, projects, and communications. Our platform connects every interaction‚Äîfrom first contact to final follow-up‚Äîso nothing falls through the cracks.",
      mission: "We aim to help teams work smarter, not harder. By combining automation, analytics, and collaboration tools, Segwik creates a single hub that keeps your business organized and responsive to client needs.",
      values: "Professionalism, accountability, and precision guide everything we do. We believe that attention to detail builds trust and that consistency creates success.",
      diff: "Segwik eliminates the chaos of scattered spreadsheets and disconnected apps. With built-in automation and intuitive design, we help teams adapt quickly without requiring months of onboarding or tech setup."
    },
    {
      overview: "Segwik serves as the operating foundation for professionals who value organization and efficiency. We help teams centralize their data, streamline operations, and maintain high standards in client communication.",
      mission: "Our goal is to create reliable digital infrastructure that scales with your business. Whether you‚Äôre managing a few clients or hundreds, Segwik provides the tools to keep your work consistent, clear, and professional.",
      values: "Integrity, dependability, and excellence define our culture. We take pride in delivering stable technology that professionals can count on every day.",
      diff: "Segwik stands out by offering a structured, professional experience built for results-driven teams. Our tools don‚Äôt just manage data‚Äîthey elevate the quality of every client relationship."
    }
  ],

  innovative: [
    {
      overview: "Segwik redefines how small teams build relationships by merging automation, intelligence, and design. We combine the science of workflow with the art of personalization to help businesses communicate better and scale faster.",
      mission: "Our mission is to push boundaries in customer engagement by blending cutting-edge AI with real human insight. We create technology that feels intuitive, adaptive, and empowering‚Äînever complicated.",
      values: "Innovation, creativity, and progress drive us forward. We believe in staying curious, challenging conventions, and building tools that inspire people to work smarter every day.",
      diff: "Segwik delivers forward-thinking automation that evolves with your business. Our platform adapts dynamically to your workflow, offering next-generation capabilities without the enterprise-level complexity."
    },
    {
      overview: "We help businesses innovate the way they connect with clients. Through AI-driven insights and automation, Segwik transforms ordinary interactions into opportunities for deeper engagement and lasting relationships.",
      mission: "We strive to make innovation accessible. By simplifying advanced technology, we allow small businesses to leverage the same intelligent systems that power large organizations.",
      values: "We value curiosity, experimentation, and the courage to try new ideas. Every update and feature we build reflects our belief in constant learning and innovation.",
      diff: "Unlike traditional CRMs, Segwik continuously learns from your activity. It predicts needs, automates responses, and helps your business stay ahead of the curve."
    },
    {
      overview: "Segwik was designed for forward-thinking teams that see technology as a partner, not a burden. We empower modern professionals to work more creatively and adaptively using smart, flexible automation.",
      mission: "To bridge the gap between technology and human connection. We want innovation to enhance, not replace, authentic relationships in business.",
      values: "Innovation, responsiveness, and authenticity guide everything we do. We believe the best solutions are both intelligent and human-centered.",
      diff: "Segwik sets itself apart with adaptable tools that grow with you. Our intelligent automation anticipates next steps and removes barriers so your ideas can move faster."
    }
  ],

  reliable: [
    {
      overview: "Segwik is the dependable backbone for relationship-driven businesses. We provide tools that help teams operate with consistency, accuracy, and confidence every day.",
      mission: "Our mission is to give professionals peace of mind by creating systems that simply work. We handle the technical complexity so you can focus on building meaningful human connections.",
      values: "Trust, dependability, and consistency are at the heart of Segwik. We believe in long-term reliability over short-term trends.",
      diff: "Segwik distinguishes itself by providing a stable, secure platform built to last. Our performance and uptime ensure your operations never skip a beat."
    },
    {
      overview: "At Segwik, reliability means everything. We support small teams and growing businesses with tools that are intuitive, predictable, and dependable‚Äîno surprises, just results.",
      mission: "We‚Äôre committed to helping our users deliver consistent experiences to their clients. When your tools work flawlessly, your relationships thrive.",
      values: "Honesty, responsibility, and service guide how we build and support our technology. We take pride in earning the trust of our users every day.",
      diff: "Segwik stands apart for its simplicity and dependability. Every feature is designed to work smoothly, ensuring you never lose data or momentum."
    },
    {
      overview: "Segwik helps businesses operate with confidence through technology they can trust. From communication to workflow tracking, every component is built for reliability and consistency.",
      mission: "Our purpose is to give users a system that just works‚Äîevery time. We want you to spend less time troubleshooting and more time connecting with your clients.",
      values: "We believe in transparency, stability, and follow-through. Our users depend on us, and we take that responsibility seriously.",
      diff: "While other platforms chase trends, Segwik focuses on dependable performance. We‚Äôre the quiet engine that keeps your business running smoothly behind the scenes."
    }
  ],

  friendly: [
    {
      overview: "Segwik is your friendly home for keeping track of every conversation, task, and relationship. We make organization feel approachable and easy, so following up doesn‚Äôt feel like a chore.",
      mission: "We want to make growing your business feel personal and fun again. By combining smart tools with a warm user experience, we help you stay connected effortlessly.",
      values: "Kindness, transparency, and helpfulness guide everything we do. We believe technology should feel supportive, not stressful.",
      diff: "Segwik stands out for its human touch. Our tools are designed for real people‚Äînot just power users‚Äîso you can enjoy building relationships instead of managing systems."
    },
    {
      overview: "Segwik helps you stay in touch with clients in a genuine, friendly way. We simplify organization so you can focus on what truly matters‚Äîpeople.",
      mission: "Our mission is to help you communicate with ease and warmth. Whether it‚Äôs a reminder, follow-up, or introduction, we make every interaction feel natural.",
      values: "We value approachability, empathy, and positivity. Every feature we design supports real human connection.",
      diff: "Segwik keeps technology simple and human. We make complex tasks feel easy, so you can focus on nurturing relationships instead of wrestling with software."
    },
    {
      overview: "Segwik brings friendliness and simplicity to your daily workflow. We help businesses build long-lasting relationships by keeping communication open and approachable.",
      mission: "To make every digital interaction feel like a real conversation. We believe business can be warm, personable, and still professional.",
      values: "Joy, empathy, and clarity are our guiding principles. We design experiences that make people smile and feel understood.",
      diff: "Segwik delivers an experience that feels light and approachable while still being powerful. We make relationship management feel natural and enjoyable."
    }
  ],

  bold: [
    {
      overview: "Segwik is the command center for businesses that move fast and aim high. We cut through noise, speed up follow-up, and turn daily chaos into organized momentum.",
      mission: "We‚Äôre on a mission to eliminate busywork and give power back to the people doing the work. We help bold thinkers move faster and smarter with clarity and control.",
      values: "Momentum, ownership, and candor drive us forward. We believe in taking decisive action and celebrating results.",
      diff: "Segwik stands apart with lightning-fast automation and a clean, intuitive design that keeps teams focused on winning‚Äînot managing systems."
    },
    {
      overview: "For those who like to make things happen, Segwik provides the platform to do it. We help you lead with energy, clarity, and control over every client touchpoint.",
      mission: "Our goal is to supercharge follow-up and accelerate growth. We believe that when communication moves fast, business follows.",
      values: "Drive, courage, and focus are the foundation of our work. We encourage decisive action and direct communication.",
      diff: "Segwik is built for bold professionals who want speed without losing precision. We help you make an impression‚Äîquickly and effectively."
    },
    {
      overview: "Segwik helps high-energy teams stay sharp and unstoppable. We turn follow-up from a chore into a competitive advantage with tools built for speed and impact.",
      mission: "To give ambitious teams the tools to act fast and stay organized. We believe growth comes from confidence, clarity, and action.",
      values: "Determination, excellence, and forward motion define us. We move with purpose and help our users do the same.",
      diff: "Segwik delivers an edge to high-performance professionals. Our streamlined interface and automation tools keep you two steps ahead."
    }
  ],

  thoughtful: [
    {
      overview: "Segwik brings thoughtful structure to relationship management. We help professionals organize their communication and workflows with clarity and empathy so every interaction feels intentional.",
      mission: "Our mission is to elevate the quality and consistency of every customer experience. We believe great relationships come from genuine care backed by reliable systems.",
      values: "Empathy, rigor, and continuous learning are the foundation of our work. We aim to build technology that supports human thoughtfulness, not replaces it.",
      diff: "Segwik differentiates itself by offering calm, structured automation that complements your natural workflow. We help teams work smarter while maintaining a human touch."
    },
    {
      overview: "Segwik provides clarity and organization for teams who value precision and purpose. Every feature is built to make client communication smoother and more thoughtful.",
      mission: "We‚Äôre here to help professionals lead with empathy and consistency. Our tools make it easy to show clients that their experience truly matters.",
      values: "Stewardship, intentionality, and respect guide our development. We build tools that support meaningful, long-term relationships.",
      diff: "Segwik‚Äôs design philosophy is quiet and deliberate. We enhance your workflow without overwhelming it, offering support exactly where you need it."
    },
    {
      overview: "Segwik is built for professionals who believe relationships deserve care and attention. We help you bring structure and thoughtfulness to every step of the client journey.",
      mission: "To simplify operations without losing the personal touch. We create tools that balance automation with authenticity, making every interaction meaningful.",
      values: "Consideration, honesty, and precision define us. We design with empathy to make organization feel intuitive and calm.",
      diff: "Segwik‚Äôs difference lies in balance‚Äîwe automate what helps and leave room for the human moments that matter most."
    }
  ]
};

function fillFromDummy(){
  const set = DUMMY[chosenPersona][dummyIdx % DUMMY[chosenPersona].length];
  coOverview.value=set.overview; coMission.value=set.mission; coValues.value=set.values; coDiff.value=set.diff; dummyIdx++;
}
function withLoader(fn){ overlay.classList.add('show'); setTimeout(()=>{ fn(); overlay.classList.remove('show'); renderMail(); }, 800); }
// Attach regenerate handler to all buttons with data-regen
document.querySelectorAll('[data-regen]').forEach(btn=>{
  const step = stepNameForElement(btn);
  btn.addEventListener('click', ()=>{
    // Show the attention animation only once when the user clicks
    animateRegenButtonsOnce(step, 'click');
    withLoader(fillFromDummy);
  });
});



/* ========= Subject / Logo step nav ========= */

document.getElementById('handoffPreviewCard')?.addEventListener('click', ()=>{
  // Use the same behavior as your other preview button (mock or real)
  // If you want to match your existing mock preview:
  alert('Mock: Opening public vCard link');
  // Or call the same function you use for #btnPreviewCard if you have one.
});


/* ========= Entry (how automation begins) ========= */
const entryDefs = [
  {key:'download', label:'Downloaded My Personal Digital Card', locked:false},
  {key:'form',     label:'Submitted a Contact Form', locked:true},
  {key:'booked',   label:'Booked a Meeting', locked:true},
  {key:'attended', label:'Attended an Event', locked:true},
  {key:'clicked',  label:'Clicked a Link in an Email', locked:true},
  {key:'scanned',  label:'Scanned your vCard QR Code', locked:true},
];
let chosenEntry = 'download';

function renderEntryChips(){
  const host = document.getElementById('entryChips');
  if(!host) return;
  host.innerHTML = '';
  entryDefs.forEach(e=>{
    const b = document.createElement('button');
    b.className = 'chip' + (chosenEntry===e.key?' active':'');
    b.textContent = e.label + (e.locked ? ' üîí' : '');
    b.style.textAlign = 'left';
    b.onclick = ()=>{
      if(e.locked){
        // Show same upgrade modal but with different heading
        const title = document.getElementById('upgTitle');
        if(title) title.textContent = 'Unlock more ways to start your journeys.';
        upg.classList.add('show');
        return;
      }
      chosenEntry = e.key;
      renderEntryChips();
    };
    host.appendChild(b);
  });
}
renderEntryChips();

/* Entry footer controls */
document.getElementById('entryCustomLink')?.addEventListener('click', ()=>{
  const title = document.getElementById('upgTitle');
  if(title) title.textContent = 'Unlock more ways to start your journeys.';
  upg.classList.add('show');
});






/* ========= Form Preview sheet ========= */
const formSheet = document.getElementById('formPreviewSheet');
function toggleFormPreview(show){
  formSheet.classList.toggle('show', !!show);
  formSheet.setAttribute('aria-hidden', show ? 'false' : 'true');
}
document.getElementById('viewDownloadForm')?.addEventListener('click', ()=>toggleFormPreview(true));
document.getElementById('previewVCardBtn')?.addEventListener('click', ()=>togglePeek(true));
document.getElementById('previewVCardBtn2')?.addEventListener('click', ()=>togglePeek(true));

document.getElementById('formPreviewClose')?.addEventListener('click', ()=>toggleFormPreview(false));
window.addEventListener('keydown', (e)=>{ if(e.key==='Escape' && formSheet.classList.contains('show')) toggleFormPreview(false); });



/* ========= Phone-styled Email Preview ========= */
let phoneModalOpen = false;
const phoneModal = document.getElementById('phonePreview');
function togglePhone(show, previewKey = null){
  phoneModal.classList.toggle('show', !!show);
  phoneModal.setAttribute('aria-hidden', show ? 'false' : 'true');
  phoneModalOpen = !!show;
  if(show) { syncPhoneTitle(); renderMail(previewKey); }
}

document.getElementById('phoneClose')?.addEventListener('click', ()=>togglePhone(false));
document.getElementById('peekEmail1')?.addEventListener('click', ()=>togglePhone(true, null));
document.getElementById('peekEmail2')?.addEventListener('click', ()=>togglePhone(true, null));

function syncPhoneTitle(){
  const txt = safe(S.subject?.value, "It‚Äôs great to be connected!");
  const t1 = document.getElementById('phoneTitle');
  if(t1) t1.textContent = txt;
  const t2 = document.getElementById('fullPhoneTitle');
  if(t2) t2.textContent = txt;
}



function socialButtons(){
  return socials.filter(s=>s.url).map(s=>{
    const key=socialIconKey(s.platform);
    return `<a href="${s.url}" target="_blank" rel="noopener" aria-label="${key}">${i16(key)}</a>`;
  }).join('');
}

function renderMail(previewKey = null){
  const subj = safe(S.subject?.value, "It‚Äôs great to be connected!");
  const logo = logoUrl ? `<div style="text-align:center;margin-bottom:10px"><img src="${logoUrl}" alt="logo" style="max-width:160px;max-height:60px;object-fit:contain"/></div>` : '';

  const signature = `
    <div class="sig">
      ${photoUrl?`<img src="${photoUrl}" alt="headshot">`:''}
      <div class="meta">
        <div class="name">${safe(S.firstName?.value,'[First]')} ${safe(S.lastName?.value,'[Last]')}</div>
        <div>${safe(S.company?.value,'[Company]')}</div>
        ${safe(S.emailBiz?.value,'')?`<div>${S.emailBiz.value}</div>`:''}
        ${safe(S.phoneBiz?.value,'')?`<div>${S.phoneBiz.value}</div>`:''}
        ${socials.length?`<div class="socials">${socialButtons()}</div>`:''}
      </div>
    </div>`;

/* Build CTA once ‚Äî used in both üëÅ modal and Final Check */
const templateKey = previewKey || chosenTemplate;
let ctaHtml = '';
if (templateKey === 'book') {
  const dest = safe(S.ctaDest?.value, '');
  const href = dest || '#';
  ctaHtml = `<p style="margin:18px 0"><a class="cta-btn" href="${href}" target="_blank" rel="noopener">Book a Meeting</a></p>`;
} else if (templateKey === 'email') {
  const mail = safe(S.emailBiz?.value, '');
  const href = mail ? `mailto:${mail}` : '#';
  ctaHtml = `<p style="margin:18px 0"><a class="cta-btn" href="${href}">Send Me an Email</a></p>`;
} else if (templateKey === 'call') {
  const ph = safe(S.phoneBiz?.value, '');
  const href = ph ? `tel:${ph.replace(/[^+\d]/g,'')}` : '#';
  ctaHtml = `<p style="margin:18px 0"><a class="cta-btn" href="${href}">Call Me</a></p>`;
}


/* Phone modal (üëÅ) preview ‚Äî CTA now included BEFORE the footer */
  const htmlPhone = `
  <div class="mail-body">
    ${logo}
    <p>Hello [firstname], thanks for downloading my digital business card ‚Äî I‚Äôm excited we crossed paths. Let me introduce myself a bit more:</p>

    <p style="font-weight:800;margin-top:12px">About My Business</p>
    <p>${safe(coOverview?.value,'[company_overview]')}</p>

    <p style="font-weight:800;margin-top:12px">What Drives Us</p>
    <p>${safe(coMission?.value,'[mission_statement]')}</p>

    <p style="font-weight:800;margin-top:12px">What Makes Us Different</p>
    <p>${safe(coDiff?.value,'[organization_values]')}</p>

    <p style="font-weight:800;margin-top:12px">Our Core Values</p>
    <p>${safe(coValues?.value,'[differentiating_propositions]')}</p>

    ${ctaHtml}
    ${signature}
  </div>
`;

   
  /* Step 5 (Final Check) full preview ‚Äî CTA appears BEFORE the footer */
  const htmlFull = `
    <div class="mail-body">
      ${logo}
      <p>Hello [firstname], thanks for downloading my digital business card ‚Äî I‚Äôm excited we crossed paths. Let me introduce myself a bit more:</p>

      <p style="font-weight:800;margin-top:12px">About My Business</p>
      <p>${safe(coOverview?.value,'[company_overview]')}</p>

      <p style="font-weight:800;margin-top:12px">What Drives Us</p>
      <p>${safe(coMission?.value,'[mission_statement]')}</p>

      <p style="font-weight:800;margin-top:12px">What Makes Us Different</p>
      <p>${safe(coDiff?.value,'[organization_values]')}</p>

      <p style="font-weight:800;margin-top:12px">Our Core Values</p>
      <p>${safe(coValues?.value,'[differentiating_propositions]')}</p>

      ${ctaHtml}
      ${signature}
    </div>
  `;

  const hostPhone = document.getElementById('mailPreview');
  if(hostPhone) hostPhone.innerHTML = htmlPhone;

  const hostFull = document.getElementById('mailPreviewFull');
  if(hostFull) hostFull.innerHTML = htmlFull;
}


/* ========= Buttons & Summary Toggle ========= */
document.getElementById('btnPreviewCard')?.addEventListener('click', ()=>alert('Mock: Opening public vCard link'));
document.getElementById('btnFillInfo')?.addEventListener('click', ()=>goTo(1));
document.getElementById('seeExamples')?.addEventListener('click', ()=>{ alert('Mock: shows a gallery of sample vCards.'); });

const toggle = document.getElementById('toggle');
toggle?.addEventListener('click', ()=>{
  const on = toggle.classList.toggle('on');
  toggle.setAttribute('aria-checked', on ? 'true' : 'false');
  alert(on ? 'Journey activated' : 'Journey deactivated');
});

/* ===== Final Check actions ===== */
document.getElementById('sendTestBtn')?.addEventListener('click', ()=>{
  // show push
  const p = document.getElementById('testPush');
  if(p){
    p.textContent = 'Test email sent to your address.';
    p.classList.add('show');
    setTimeout(()=> p.classList.remove('show'), 2200);
  }
  // (No actual send; this is a UI confirmation only.)
});

document.getElementById('addMoreFollowups')?.addEventListener('click', ()=>{
  // open upgrade modal with required copy
  const title = document.getElementById('upgTitle');
  if(title) title.textContent = 'Requires an Upgrade';
  const modal = document.querySelector('#upgradeModal .modal p');
  if(modal) modal.innerHTML = 'Adding another follow-up email is available on paid plans.';
  document.getElementById('upgradeModal')?.classList.add('show');
});
// Auto-expand textareas while typing
document.addEventListener('input', e => {
  if (e.target.tagName.toLowerCase() === 'textarea') {
    e.target.style.height = 'auto';
    e.target.style.height = (e.target.scrollHeight) + 'px';
  }
});


/* ========= Init ========= */
renderSocialRows();
/* (replaced) render of new personality UI happens on load above */
goTo(0);
updatePreviews();
syncPhoneTitle();
renderMail();



</script>
</body>
</html>
